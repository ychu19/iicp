---
title: "IICP: Playing with ESS"
author: "Yuan-Ning Chu"
date: "10/27/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plm) # fixed effect
library(stargazer)
```

```{r ess, echo=TRUE, message=FALSE, warning=FALSE}
ess_2002 = haven::read_stata("ESS1e06_6.dta")
ess_2004 = haven::read_stata("ESS2e03_6.dta")
ess_2006 = haven::read_stata("ESS3e03_7.dta")
ess_2008 = haven::read_stata("ESS4e04_5.dta")
ess_2010 = haven::read_stata("ESS5e03_4.dta")
    
# table(ess_2002$cntry)
# table(ess_2002$essround)

```

```{r ess_yr, echo=TRUE, message=FALSE, warning=FALSE}
ess_2002 = ess_2002 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrth, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma) %>%
  plyr::rename(c("cntbrth"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
ess_2004 = ess_2004 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrtha, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma) %>%
  plyr::rename(c("cntbrtha"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
ess_2006 = ess_2006 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrtha, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma) %>%
  plyr::rename(c("cntbrtha"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
ess_2008 = ess_2008 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrthb, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma) %>%
  plyr::rename(c("cntbrthb"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
ess_2010 = ess_2010 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecnta, cntbrthb, gndr, edulvlb, facntr, mocntr, polintr, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghom1) %>%
  plyr::rename(c("cntbrthb"="birthplace","blgetmg"="ethnic", "edulvlb"="edu","livecnta" = "livecntr","brncntr"="fborn", "lnghom1"="lnghoma"))
ess_2010$livecntr = ess_2010$livecntr - 2010
ess_2010$livecntr = ifelse(ess_2010$livecntr >= 1, 1,
                           ifelse(ess_2010$livecntr %in% c(-1:-5), 2,
                                  ifelse(ess_2010$livecntr %in% c(-6:-10), 3,
                                         ifelse(ess_2010$livecntr %in% c(-11:-20), 4,
                                                ifelse(ess_2010$livecntr < -20, 5, NA)))))
ess_2010$polcmpl = NA
ess_2010$poldcs = NA
```

```{r ess_civix, echo=TRUE, message=FALSE, warning=FALSE}
ess_raw = rbind(ess_2002, ess_2004, ess_2006, ess_2008, ess_2010)
ess_raw$sec.immi = ifelse(ess_raw$facntr == 2 | ess_raw$mocntr == 2, 1, 0)
ess_raw$ethnic = ifelse(ess_raw$ethnic == 1, 1,
                        ifelse(ess_raw$ethnic == 2, 0, NA))
ess_raw$citizen = ifelse(ess_raw$ctzcntr == 1, 1,
                         ifelse(ess_raw$ctzcntr == 2, 0, NA))
ess_raw$residence = ifelse(ess_raw$livecntr <= 3, 1, 0) # 1 = lived less than 10 yrs, 0 = lived more than 10 yrs
ess_raw$birthplace = ifelse(ess_raw$birthplace %in% c(66,77,88,99,"02","03","04","06"), NA, ess_raw$birthplace)
  # ess_raw = ess_raw[complete.cases(ess_raw$birthplace),]
  eu_member = c("BE", "FR", "DE", "IT", "LU", "NL", "DK", "IE", "GB", "GR", "PT", "ES","AT","SE")
  ess_raw$eubirth = ifelse(ess_raw$birthplace %in% eu_member, 1, 0)
ess_raw$female = ifelse(ess_raw$gndr == 2, 1, 
                        ifelse(ess_raw$gndr == 1, 0, NA))
ess_raw$edu = ifelse(ess_raw$edu > 5, NA, ess_raw$edu)
ess_raw$fborn = ifelse(ess_raw$fborn == 1, 0, 1) # now 1 as foreign born, 0 as native born

ess_raw$polintr = ifelse(ess_raw$polintr > 4, NA, ess_raw$polintr)
# table(ess_raw$polcmpl) whether politics are too complicated to understand, 5 as always, 1 as never
# table(ess_raw$poldcs) how difficult it is to make mind up about political issues, 5 as very easy, 1 as very difficult
ess_raw$poldcs = ifelse(ess_raw$poldcs == 5, 1, 
                        ifelse(ess_raw$poldcs == 4, 2, 
                               ifelse(ess_raw$poldcs == 3, 3, 
                                      ifelse(ess_raw$poldcs == 2, 4, 
                                             ifelse(ess_raw$poldcs == 1, 5, ess_raw$poldcs)))))
ess_raw$hincfel = ifelse(ess_raw$hincfel > 4, NA, ess_raw$hincfel)
ess_raw$ppltrst = ifelse(ess_raw$ppltrst > 10, NA, ess_raw$ppltrst) # 0 as can't be too careful, 10 as most people can be trusted
ess_raw$pplfair = ifelse(ess_raw$pplfair > 10, NA, ess_raw$pplfair) # 0 as most people take advantage, 10 as most people are fair
ess_raw$employ = ifelse(ess_raw$uempla == 0, 1, 0) # 1 = employed, 0 = unemployed

```

```{r citizen mean, message=FALSE, warning=FALSE}
ess_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry,polintr, hincfel, employ, ppltrst, pplfair, polcmpl, poldcs) %>%
  summarise(mean.poli = mean(polintr, na.rm = TRUE),
            mean.employ = mean(employ, na.rm = TRUE),
            mean.hincfel = mean(hincfel, na.rm = TRUE),
            mean.ppltrst = mean(ppltrst, na.rm = TRUE),
            mean.pplfair = mean(pplfair, na.rm = TRUE),
            mean.polcmpl = mean(polcmpl, na.rm = TRUE),
            mean.poldcs = mean(poldcs, na.rm = TRUE))

# ess_mean = ess_raw %>% filter(citizen == 1) %>% group_by(cntry) %>% 
#   select(cntry,polintr, hincfel, employ, ppltrst, pplfair) %>%
#   summarise(mean.poli = mean(polintr, na.rm = TRUE),
#             mean.employ = mean(employ, na.rm = TRUE),
#             mean.hincfel = mean(hincfel, na.rm = TRUE),
#             mean.ppltrst = mean(ppltrst, na.rm = TRUE),
#             mean.pplfair = mean(pplfair, na.rm = TRUE))
# 
# ess_mean.comp = ess_mean %>% left_join(ess_mean.1, by='cntry')


ess_tenyr = ess_raw %>% filter(residence == 1)

ess_tenyr = ess_tenyr %>% left_join(ess_mean, by='cntry')

ess_h.tenyr = ess_tenyr %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.tenyr = ess_tenyr %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

```

```{r ess_gap, echo=TRUE, message=FALSE, warning=FALSE}



ess_h.tenyr = ess_h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_l.tenyr = ess_l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )


```




# Descriptive Analysis: Replicating Goodman and Wright (2015) with different definition of `immigrants'

```{r noncitizen, message=FALSE, warning=FALSE}
ess_nonciti = ess_raw %>% filter(citizen == 0)

ess_nonciti = ess_nonciti %>% left_join(ess_mean, by='cntry')

ess_h.nonciti = ess_nonciti %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.nonciti = ess_nonciti %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

ess_h.nonciti = ess_h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_l.nonciti = ess_l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

```{r}
ess_fborn = ess_raw %>% filter(fborn == 1) 
ess_fborn = ess_fborn %>% left_join(ess_mean, by='cntry')

ess_h.fborn = ess_fborn %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.fborn = ess_fborn %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

ess_l.fborn = ess_l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_h.fborn = ess_h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

```


## Noncitizens in ESS

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(hincfel.h.1$residuals) 1698

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(employ.h.1$residuals) 1813
# length(employ.l.1$residuals) 2673

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX among Non-citizens', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1804
# length(ppltrst.l.1$residuals) 1657

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Less than 10-years of residence

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Foreign borns

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15, foreign-borns', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(hincfel.h.1$residuals) 4101
# length(hincfel.l.1$residuals) 4379

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(employ.h.1$residuals)
# length(employ.l.1$residuals)

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(ppltrst.h.1$residuals) 4388
# length(ppltrst.l.1$residuals) 4398

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Thinking about birthright citizenship

```{r birthright, echo=TRUE, message=FALSE, warning=FALSE}
list.cntry = as.vector(unique(ess_raw$cntry))
birthright = c("GB", "PT", "DE", "BE", "DK", "FR", "NL")
no.birthright = list.cntry[!list.cntry %in% birthright]

h.civix = c("DK", "NL", "DE", "AT", "FR", "GB", "GR")
l.civix = c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT")

```

### With birthright citizenship

```{r}
b.h = birthright[birthright %in% h.civix]
b.l = birthright[birthright %in% l.civix]

dat.b.h = ess_raw %>% filter(cntry %in% b.h)
dat.b.h = dat.b.h %>% left_join(ess_mean, by='cntry')
dat.b.l = ess_raw %>% filter(cntry %in% b.l)
dat.b.l = dat.b.l %>% left_join(ess_mean, by='cntry')

dat.b.h.nonciti = dat.b.h %>% filter(citizen == 0)
dat.b.h.tenyr = dat.b.h %>% filter(residence == 1)
dat.b.h.fborn = dat.b.h %>% filter(fborn == 1) 

dat.b.l.nonciti = dat.b.l %>% filter(citizen == 0)
dat.b.l.tenyr = dat.b.l %>% filter(residence == 1)
dat.b.l.fborn = dat.b.l %>% filter(fborn == 1) 

dat.b.h.nonciti = dat.b.h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.nonciti = dat.b.l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.h.tenyr = dat.b.h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.tenyr = dat.b.l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.h.fborn = dat.b.h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.fborn = dat.b.l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



#### Non-citizens



```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



#### Foreign-borns


```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, foreign-brons', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



### W/o birthright citizenship

```{r}
n.b.h = no.birthright[no.birthright %in% h.civix]
n.b.l = no.birthright[no.birthright %in% l.civix]

dat.n.b.h = ess_raw %>% filter(cntry %in% n.b.h)
dat.n.b.h = dat.n.b.h %>% left_join(ess_mean, by='cntry')
dat.n.b.l = ess_raw %>% filter(cntry %in% n.b.l)
dat.n.b.l = dat.n.b.l %>% left_join(ess_mean, by='cntry')

dat.n.b.h.nonciti = dat.n.b.h %>% filter(citizen == 0)
dat.n.b.h.tenyr = dat.n.b.h %>% filter(residence == 1)
dat.n.b.h.fborn = dat.n.b.h %>% filter(fborn == 1) 

dat.n.b.l.nonciti = dat.n.b.l %>% filter(citizen == 0)
dat.n.b.l.tenyr = dat.n.b.l %>% filter(residence == 1)
dat.n.b.l.fborn = dat.n.b.l %>% filter(fborn == 1) 

dat.n.b.h.nonciti = dat.n.b.h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.nonciti = dat.n.b.l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.h.tenyr = dat.n.b.h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.tenyr = dat.n.b.l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.h.fborn = dat.n.b.h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.fborn = dat.n.b.l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

#### Ten-year residence

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

#### Non-citizens

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

#### Foreign-borns

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```









# Testing different DVs

## Political Incorporation
```{r new dvs for poli incop, message=FALSE, warning=FALSE}

# ess_raw$contplt # Contacted politician or government official last 12 months

# ess_raw$wrkprty # Worked in political party or action group last 12 months
# 
# ess_raw$wrkorg # Worked in another organisation or association last 12 months
# 
# ess_raw$badge # Worn or displayed campaign badge/sticker last 12 months
# 
# ess_raw$sgnptit # Signed petition last 12 months
# 
# ess_raw$pbldmn # Taken part in lawful public demonstration last 12 months
# 
# ess_raw$bctprd # Boycotted certain products last 12 months

## ess_raw$dntmny # Donated money to political organisation or group last 12 months

## ess_raw$ilglpst # Participated illegal protest activities last 12 months

# ess_raw$stfgov # How satisfied with the national government

pol_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stfgov) %>%
  summarise(mean.contplt = mean(contplt, na.rm = TRUE),
            mean.wrkprty = mean(wrkprty, na.rm = TRUE),
            mean.wrkorg = mean(wrkorg, na.rm = TRUE),
            mean.badge = mean(badge, na.rm = TRUE),
            mean.sgnptit = mean(sgnptit, na.rm = TRUE),
            mean.pbldmn = mean(pbldmn, na.rm = TRUE),
            mean.bctprd = mean(bctprd, na.rm = TRUE),
            # mean.dntmny = mean(dntmny, na.rm = TRUE),
            # mean.ilglpst = mean(ilglpst, na.rm = TRUE),
            mean.stfgov = mean(stfgov, na.rm = TRUE))

ess_pol = ess_raw %>% filter(residence == 1)
ess_pol = ess_pol %>% left_join(pol_mean, by='cntry')

pol_h = ess_pol %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
pol_l = ess_pol %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

pol_h = pol_h %>%  mutate(
  contplt.gap = contplt - mean.contplt, 
  wrkprty.gap = wrkprty - mean.wrkprty,
  wrkorg.gap = wrkorg - mean.wrkorg, 
  badge.gap = badge - mean.badge,
  sgnptit.gap = sgnptit - mean.sgnptit, 
  pbldmn.gap = pbldmn - mean.pbldmn,
  bctprd.gap = bctprd - mean.bctprd,
  stfgov.gap = stfgov - mean.stfgov
  )

pol_l = pol_l %>%  mutate(
  contplt.gap = contplt - mean.contplt, 
  wrkprty.gap = wrkprty - mean.wrkprty,
  wrkorg.gap = wrkorg - mean.wrkorg, 
  badge.gap = badge - mean.badge,
  sgnptit.gap = sgnptit - mean.sgnptit, 
  pbldmn.gap = pbldmn - mean.pbldmn,
  bctprd.gap = bctprd - mean.bctprd,
  stfgov.gap = stfgov - mean.stfgov
  )
```

```{r contplt model, fig.height=1.5, fig.cap='Whether have worked in political party or action group last 12 months'}

pol.h.1 = lm(contplt ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
pol.h.2 = lm(contplt.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
pol.l.1 = lm(contplt ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
pol.l.2 = lm(contplt.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(pol.h.1$coefficients[1],confint(pol.h.1)[1,]))
absolute.l = as.vector(c(pol.l.1$coefficients[1],confint(pol.l.1)[1,]))

gap.h = as.vector(c(pol.h.2$coefficients[1],confint(pol.h.2)[1,]))
gap.l = as.vector(c(pol.l.2$coefficients[1],confint(pol.l.2)[1,]))

contplt.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(contplt.1) = c("intercept", "min", "max")
contplt.1 = contplt.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
contplt.1$var = factor(contplt.1$var, as.character(contplt.1$var))

ggplot(contplt.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r wrkprty model, fig.height=1.5, fig.cap='Whether have contacted politician or government official last 12 months'}
wrkprty.h.1 = lm(wrkprty ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
wrkprty.h.2 = lm(wrkprty.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
wrkprty.l.1 = lm(wrkprty ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
wrkprty.l.2 = lm(wrkprty.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(wrkprty.h.1$coefficients[1],confint(wrkprty.h.1)[1,]))
absolute.l = as.vector(c(wrkprty.l.1$coefficients[1],confint(wrkprty.l.1)[1,]))

gap.h = as.vector(c(wrkprty.h.2$coefficients[1],confint(wrkprty.h.2)[1,]))
gap.l = as.vector(c(wrkprty.l.2$coefficients[1],confint(wrkprty.l.2)[1,]))

wrkprty.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wrkprty.1) = c("intercept", "min", "max")
wrkprty.1 = wrkprty.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wrkprty.1$var = factor(wrkprty.1$var, as.character(wrkprty.1$var))

ggplot(wrkprty.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r wrkorg model, fig.height=1.5, fig.cap='Whether have worked in political party or action group last 12 months'}
wrkorg.h.1 = lm(wrkorg ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
wrkorg.h.2 = lm(wrkorg.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
wrkorg.l.1 = lm(wrkorg ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
wrkorg.l.2 = lm(wrkorg.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(wrkorg.h.1$coefficients[1],confint(wrkorg.h.1)[1,]))
absolute.l = as.vector(c(wrkorg.l.1$coefficients[1],confint(wrkorg.l.1)[1,]))

gap.h = as.vector(c(wrkorg.h.2$coefficients[1],confint(wrkorg.h.2)[1,]))
gap.l = as.vector(c(wrkorg.l.2$coefficients[1],confint(wrkorg.l.2)[1,]))

wrkorg.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wrkorg.1) = c("intercept", "min", "max")
wrkorg.1 = wrkorg.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wrkorg.1$var = factor(wrkorg.1$var, as.character(wrkorg.1$var))

ggplot(wrkorg.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r badge model, fig.height=1.5, fig.cap='Whether have worn or displayed campaign badge/sticker last 12 months'}

badge.h.1 = lm(badge ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
badge.h.2 = lm(badge.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
badge.l.1 = lm(badge ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
badge.l.2 = lm(badge.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(badge.h.1$coefficients[1],confint(badge.h.1)[1,]))
absolute.l = as.vector(c(badge.l.1$coefficients[1],confint(badge.l.1)[1,]))

gap.h = as.vector(c(badge.h.2$coefficients[1],confint(badge.h.2)[1,]))
gap.l = as.vector(c(badge.l.2$coefficients[1],confint(badge.l.2)[1,]))

badge.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(badge.1) = c("intercept", "min", "max")
badge.1 = badge.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
badge.1$var = factor(badge.1$var, as.character(badge.1$var))

ggplot(badge.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r sgnptit model, fig.height=1.5, fig.cap='Whether signed petition last 12 months'}

sgnptit.h.1 = lm(sgnptit ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
sgnptit.h.2 = lm(sgnptit.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
sgnptit.l.1 = lm(sgnptit ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
sgnptit.l.2 = lm(sgnptit.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(sgnptit.h.1$coefficients[1],confint(sgnptit.h.1)[1,]))
absolute.l = as.vector(c(sgnptit.l.1$coefficients[1],confint(sgnptit.l.1)[1,]))

gap.h = as.vector(c(sgnptit.h.2$coefficients[1],confint(sgnptit.h.2)[1,]))
gap.l = as.vector(c(sgnptit.l.2$coefficients[1],confint(sgnptit.l.2)[1,]))

sgnptit.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(sgnptit.1) = c("intercept", "min", "max")
sgnptit.1 = sgnptit.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
sgnptit.1$var = factor(sgnptit.1$var, as.character(sgnptit.1$var))

ggplot(sgnptit.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r pbldmn model, fig.height=1.5, fig.cap='Whether taken part in lawful public demonstration last 12 months'}
pbldmn.h.1 = lm(pbldmn ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
pbldmn.h.2 = lm(pbldmn.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
pbldmn.l.1 = lm(pbldmn ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
pbldmn.l.2 = lm(pbldmn.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(pbldmn.h.1$coefficients[1],confint(pbldmn.h.1)[1,]))
absolute.l = as.vector(c(pbldmn.l.1$coefficients[1],confint(pbldmn.l.1)[1,]))

gap.h = as.vector(c(pbldmn.h.2$coefficients[1],confint(pbldmn.h.2)[1,]))
gap.l = as.vector(c(pbldmn.l.2$coefficients[1],confint(pbldmn.l.2)[1,]))

pbldmn.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pbldmn.1) = c("intercept", "min", "max")
pbldmn.1 = pbldmn.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pbldmn.1$var = factor(pbldmn.1$var, as.character(pbldmn.1$var))

ggplot(pbldmn.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r bctprd model, fig.height=1.5, fig.cap='Whether boycotted certain products last 12 months'}
bctprd.h.1 = lm(bctprd ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
bctprd.h.2 = lm(bctprd.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
bctprd.l.1 = lm(bctprd ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
bctprd.l.2 = lm(bctprd.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(bctprd.h.1$coefficients[1],confint(bctprd.h.1)[1,]))
absolute.l = as.vector(c(bctprd.l.1$coefficients[1],confint(bctprd.l.1)[1,]))

gap.h = as.vector(c(bctprd.h.2$coefficients[1],confint(bctprd.h.2)[1,]))
gap.l = as.vector(c(bctprd.l.2$coefficients[1],confint(bctprd.l.2)[1,]))

bctprd.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(bctprd.1) = c("intercept", "min", "max")
bctprd.1 = bctprd.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
bctprd.1$var = factor(bctprd.1$var, as.character(bctprd.1$var))

ggplot(bctprd.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r stfgov model, fig.height=1.5, fig.cap='How satisfied with the national government'}
stfgov.h.1 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
stfgov.h.2 = lm(stfgov.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
stfgov.l.1 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
stfgov.l.2 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(stfgov.h.1$coefficients[1],confint(stfgov.h.1)[1,]))
absolute.l = as.vector(c(stfgov.l.1$coefficients[1],confint(stfgov.l.1)[1,]))

gap.h = as.vector(c(stfgov.h.2$coefficients[1],confint(stfgov.h.2)[1,]))
gap.l = as.vector(c(stfgov.l.2$coefficients[1],confint(stfgov.l.2)[1,]))

stfgov.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(stfgov.1) = c("intercept", "min", "max")
stfgov.1 = stfgov.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
stfgov.1$var = factor(stfgov.1$var, as.character(stfgov.1$var))

ggplot(stfgov.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Social Incorporation


```{r socio incop, warning=FALSE, message=FALSE}
### social incorporation

# ess_raw$stflife # How satisfied with life as a whole
# 
# table(ess_raw$pplhlp) # Most of the time people helpful or mostly looking out for themselves (0: look out for themselves, 10: trying tobe helpful)
# 
# ess_raw$happy # How happy are you

## ess_raw$inmdisc # Anyone to discuss intimate and personal matters with

# ess_raw$aesfdrk # Feeling of safety of walking alone in local area after dark
# 
# ess_raw$health # Subjective general health
# 
# ess_raw$dscrgrp # Member of a group discriminated against in this country
# 
# ess_raw$dscrrce # Discrimination of respondent's group: colour or race
# 
# ess_raw$dscrntn # Discrimination of respondent's group: nationality
# 
# # ess_raw$dscretn # Discrimination of respondent's group: ethnic group
# 
# ess_raw$lnghoma # Language most often spoken at home: first mentioned *** COME BACK FOR THIS
# 
# ### citizen involvement
# 
# ess_raw$sptcptp # Sports/outdoor activity club, last 12 months: participated
# 
# ess_raw$cltoptp # Cultural/hobby activity organisation, last 12 months: participated
# 
# ess_raw$truptp # Trade union, last 12 months: participated
# 
# ess_raw$prfoptp # Business/profession/farmers organisation, last 12 months: participated
# 
# ess_raw$cnsoptp # Consumer/automobile organisation, last 12 months: participated
# 
# ess_raw$hmnoptp # Humanitarian organisation etc., last 12 months: participated
# 
# ess_raw$epaoptp # Environmental/peace/animal organisation, last 12 months: participated
# 
# ess_raw$rlgoptp # Religious/church organisation, last 12 months: participated
# 
# ess_raw$prtyptp # Political party, last 12 months: participated
# 
# ess_raw$setoptp # Science/education/teacher organisation, last 12 months: participated
# 
# ess_raw$sclcptp # Social club etc., last 12 months: participated
# 
# ess_raw$othvptp # Other voluntary organisation, last 12 months: participated

ess_raw$dscrgrp = ifelse(ess_raw$dscrgrp == 2, 0, ess_raw$dscrgrp) # 1 as yes, 0 as no

ess_raw = ess_raw %>% 
  filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR", "IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))  
  
main.lan.1 = ess_raw %>% group_by(cntry) %>% 
  filter(lnghoma != 999, lnghoma != 888, lnghoma != 777) %>% 
  summarise(main.lan.1 = tail(names(sort(table(lnghoma))),1))

main.lan.2 = ess_raw %>% group_by(cntry) %>% 
  filter(lnghoma != 999, lnghoma != 888, lnghoma != 777) %>% 
  summarise(main.lan.2 = tail(names(sort(table(lnghoma))),2)[1])

ess_raw = ess_raw %>% 
  left_join(main.lan.1, by = "cntry") %>% 
  left_join(main.lan.2, by = "cntry")

ess_raw = ess_raw %>% group_by(cntry) %>%
  mutate(main.lan = ifelse(lnghoma == main.lan.1 |lnghoma == main.lan.2 , 1, 0))
  # 1: speak majority language at home, 0: minority language

soc_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry, stflife, pplhlp, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, main.lan) %>%
  summarise(mean.stflife = mean(stflife, na.rm = TRUE),
            mean.pplhlp = mean(pplhlp, na.rm = TRUE),
            mean.happy = mean(happy, na.rm = TRUE),
            # mean.inmdisc = mean(inmdisc, na.rm = TRUE),
            mean.aesfdrk = mean(aesfdrk, na.rm = TRUE),
            mean.health = mean(health, na.rm = TRUE),
            mean.dscrgrp = mean(dscrgrp, na.rm = TRUE),
            mean.dscrrce = mean(dscrrce, na.rm = TRUE),
            mean.dscrntn = mean(dscrntn, na.rm = TRUE),
            mean.lan = mean(main.lan, na.rm = TRUE))
            # mean.dscretn = mean(dscretn, na.rm = TRUE),
            # mean.lnghoma = mean(lnghoma, na.rm = TRUE))
            # mean.sptcptp = mean(sptcptp, na.rm = TRUE),
            # mean.cltoptp = mean(cltoptp, na.rm = TRUE),
            # mean.truptp = mean(truptp, na.rm = TRUE),
            # mean.prfoptp = mean(prfoptp, na.rm = TRUE),
            # mean.cnsoptp = mean(cnsoptp, na.rm = TRUE),
            # mean.hmnoptp = mean(hmnoptp, na.rm = TRUE),
            # mean.epaoptp = mean(epaoptp, na.rm = TRUE),
            # mean.rlgoptp = mean(rlgoptp, na.rm = TRUE),
            # mean.prtyptp = mean(prtyptp, na.rm = TRUE),
            # mean.setoptp = mean(setoptp, na.rm = TRUE),
            # mean.sclcptp = mean(sclcptp, na.rm = TRUE),
            # mean.othvptp = mean(othvptp, na.rm = TRUE))

ess_soc = ess_raw %>% filter(residence == 1)
ess_soc = ess_soc %>% left_join(soc_mean, by='cntry')

soc_h = ess_soc %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
soc_l = ess_soc %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

soc_h = soc_h %>%  mutate(
  stflife.gap = stflife - mean.stflife, 
  pplhlp.gap = pplhlp - mean.pplhlp,
  happy.gap = happy - mean.happy,
  aesfdrk.gap = aesfdrk - mean.aesfdrk,
  health.gap = health - mean.health, 
  dscrgrp.gap = dscrgrp - mean.dscrgrp,
  dscrrce.gap = dscrrce - mean.dscrrce,
  dscrntn.gap = dscrntn - mean.dscrntn,
  lan.gap = main.lan - mean.lan
  # lnghoma.gap = lnghoma - mean.lnghoma
  )

soc_l = soc_l %>%  mutate(
  stflife.gap = stflife - mean.stflife, 
  pplhlp.gap = pplhlp - mean.pplhlp,
  happy.gap = happy - mean.happy,
  aesfdrk.gap = aesfdrk - mean.aesfdrk,
  health.gap = health - mean.health, 
  dscrgrp.gap = dscrgrp - mean.dscrgrp,
  dscrrce.gap = dscrrce - mean.dscrrce,
  dscrntn.gap = dscrntn - mean.dscrntn,
  lan.gap = main.lan - mean.lan 
  # lnghoma.gap = lnghoma - mean.lnghoma
  )

```

```{r stflife model, fig.height=1.5, fig.cap='How satisfied with life as a whole'}
stflife.h.1 = lm(stflife ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
stflife.h.2 = lm(stflife.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
stflife.l.1 = lm(stflife ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
stflife.l.2 = lm(stflife.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(stflife.h.1$coefficients[1],confint(stflife.h.1)[1,]))
absolute.l = as.vector(c(stflife.l.1$coefficients[1],confint(stflife.l.1)[1,]))

gap.h = as.vector(c(stflife.h.2$coefficients[1],confint(stflife.h.2)[1,]))
gap.l = as.vector(c(stflife.l.2$coefficients[1],confint(stflife.l.2)[1,]))

stflife.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(stflife.1) = c("intercept", "min", "max")
stflife.1 = stflife.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
stflife.1$var = factor(stflife.1$var, as.character(stflife.1$var))

ggplot(stflife.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-7.5, 7.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r pplhlp model, fig.height=1.5, fig.cap='Most of the time people helpful (10) or mostly looking out for themselves (0)'}
pplhlp.h.1 = lm(pplhlp ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
pplhlp.h.2 = lm(pplhlp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
pplhlp.l.1 = lm(pplhlp ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
pplhlp.l.2 = lm(pplhlp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(pplhlp.h.1$coefficients[1],confint(pplhlp.h.1)[1,]))
absolute.l = as.vector(c(pplhlp.l.1$coefficients[1],confint(pplhlp.l.1)[1,]))

gap.h = as.vector(c(pplhlp.h.2$coefficients[1],confint(pplhlp.h.2)[1,]))
gap.l = as.vector(c(pplhlp.l.2$coefficients[1],confint(pplhlp.l.2)[1,]))

pplhlp.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplhlp.1) = c("intercept", "min", "max")
pplhlp.1 = pplhlp.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplhlp.1$var = factor(pplhlp.1$var, as.character(pplhlp.1$var))

ggplot(pplhlp.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-7.5, 7.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r happy model, fig.height=1.5, fig.cap='How happy are you (0: exteremely unhappy, 10: extremely happy)'}
happy.h.1 = lm(happy ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
happy.h.2 = lm(happy.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
happy.l.1 = lm(happy ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
happy.l.2 = lm(happy.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(happy.h.1$coefficients[1],confint(happy.h.1)[1,]))
absolute.l = as.vector(c(happy.l.1$coefficients[1],confint(happy.l.1)[1,]))

gap.h = as.vector(c(happy.h.2$coefficients[1],confint(happy.h.2)[1,]))
gap.l = as.vector(c(happy.l.2$coefficients[1],confint(happy.l.2)[1,]))

happy.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(happy.1) = c("intercept", "min", "max")
happy.1 = happy.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
happy.1$var = factor(happy.1$var, as.character(happy.1$var))

ggplot(happy.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r aesfdrk, fig.height=1.5, fig.cap='Feeling of safety of walking alone in local area after dark (1: very safe, 4: very unsafe)'}
aesfdrk.h.1 = lm(aesfdrk ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
aesfdrk.h.2 = lm(aesfdrk.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
aesfdrk.l.1 = lm(aesfdrk ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
aesfdrk.l.2 = lm(aesfdrk.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(aesfdrk.h.1$coefficients[1],confint(aesfdrk.h.1)[1,]))
absolute.l = as.vector(c(aesfdrk.l.1$coefficients[1],confint(aesfdrk.l.1)[1,]))

gap.h = as.vector(c(aesfdrk.h.2$coefficients[1],confint(aesfdrk.h.2)[1,]))
gap.l = as.vector(c(aesfdrk.l.2$coefficients[1],confint(aesfdrk.l.2)[1,]))

aesfdrk.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(aesfdrk.1) = c("intercept", "min", "max")
aesfdrk.1 = aesfdrk.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
aesfdrk.1$var = factor(aesfdrk.1$var, as.character(aesfdrk.1$var))

ggplot(aesfdrk.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-4, 4)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```


```{r health, fig.height=1.5, fig.cap='Subjective general health (1 very good, 5 very bad)'}
health.h.1 = lm(health ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
health.h.2 = lm(health.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
health.l.1 = lm(health ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
health.l.2 = lm(health.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(health.h.1$coefficients[1],confint(health.h.1)[1,]))
absolute.l = as.vector(c(health.l.1$coefficients[1],confint(health.l.1)[1,]))

gap.h = as.vector(c(health.h.2$coefficients[1],confint(health.h.2)[1,]))
gap.l = as.vector(c(health.l.2$coefficients[1],confint(health.l.2)[1,]))

health.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(health.1) = c("intercept", "min", "max")
health.1 = health.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
health.1$var = factor(health.1$var, as.character(health.1$var))

ggplot(health.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r dscrgrp, fig.height=1.5, fig.cap='Whether a member of a group discriminated against in this country (1 yes)'}
dscrgrp.h.1 = glm(dscrgrp ~ agea + ethnic + female + edu + eubirth, data = soc_h, family = 'binomial') # absolute level
dscrgrp.h.2 = lm(dscrgrp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
dscrgrp.l.1 = glm(dscrgrp ~ agea + ethnic + female + edu + eubirth, data = soc_l, family = 'binomial') # absolute level
dscrgrp.l.2 = lm(dscrgrp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

dscrigrp.dat.h = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = dscrgrp.h.1 %>% 
  broom::augment(newdata = dscrigrp.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

dscrigrp.dat.l = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = dscrgrp.l.1 %>% 
  broom::augment(newdata = dscrigrp.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(dscrgrp.h.2$coefficients[1],confint(dscrgrp.h.2)[1,]))
gap.l = as.vector(c(dscrgrp.l.2$coefficients[1],confint(dscrgrp.l.2)[1,]))

dscrgrp.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(dscrgrp.1) = c("intercept", "min", "max")
dscrgrp.1 = dscrgrp.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
dscrgrp.1$var = factor(dscrgrp.1$var, as.character(dscrgrp.1$var))

ggplot(dscrgrp.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2, 2)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r language at home, , fig.height=1.5, fig.cap='Language at home (1 for majority language)'}

lan.h.1 = glm(main.lan ~ agea + ethnic + female + edu + eubirth, data = soc_h, family = 'binomial') # absolute level
lan.h.2 = lm(lan.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
lan.l.1 = glm(main.lan ~ agea + ethnic + female + edu + eubirth, data = soc_l, family = 'binomial') # absolute level
lan.l.2 = lm(lan.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

lan.dat.h = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = lan.h.1 %>% 
  broom::augment(newdata = lan.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

lan.dat.l = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = lan.l.1 %>% 
  broom::augment(newdata = lan.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(lan.h.2$coefficients[1],confint(lan.h.2)[1,]))
gap.l = as.vector(c(lan.l.2$coefficients[1],confint(lan.l.2)[1,]))

lan.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(lan.1) = c("intercept", "min", "max")
lan.1 = lan.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
lan.1$var = factor(lan.1$var, as.character(lan.1$var))

ggplot(lan.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

## Socio-economic incorporation

```{r socio incorporation, warning=FALSE, message=FALSE}

# pdjobev - Ever had a paid job
# pdjobyr - Year last in paid job
# emplrel - Employment relation
# emplno - Number of employees respondent has/had
# wrkctra - Employment contract unlimited or limited duration
# jbspv - Responsible for supervising other employees
# njbspv - Number of people responsible for in job
# wkdcorga - Allowed to decide how daily work is organised
# wkhtot - Total hours normally worked per week in main job overtime included
# iscoco - Occupation, ISCO88 (com)
# nacer11 - Industry, NACE rev.1.1 ##### blue versus white colar
# uemp3m - Ever unemployed and seeking work for a period more than three months
# uemp12m - Any period of unemployment and work seeking lasted 12 months or more 
# uemp5yr - Any period of unemployment and work seeking within last 5 years

```

