---
title: "IICP: Playing with ESS"
author: "Yuan-Ning Chu"
date: "10/27/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plm) # fixed effect
library(stargazer)
```

```{r ess, echo=TRUE, message=FALSE, warning=FALSE}
ess_2002 = haven::read_stata("ESS1e06_6.dta")
ess_2004 = haven::read_stata("ESS2e03_6.dta")
ess_2006 = haven::read_stata("ESS3e03_7.dta")
ess_2008 = haven::read_stata("ESS4e04_5.dta")
ess_2010 = haven::read_stata("ESS5e03_4.dta")
    
# table(ess_2002$cntry)
# table(ess_2002$essround)

```

```{r ess_yr, echo=TRUE, message=FALSE, warning=FALSE}
ess_2002 = ess_2002 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrth, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma, pdjobev, pdjobyr, emplrel, emplno, wrkctr, jbspv, wkdcorg, wkhtot, iscoco, tvpol, rdpol, nwsppol, uemp3m, uemp12m, uemp5yr, hinctnt, hincsrc, brwmny) %>%
  plyr::rename(c("cntbrth"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn", "wrkctr"="wrkctra", "wkdcorg" = "wkdcorga", "hincsrc" = "hincsrca"))
  ess_2002 = ess_2002 %>% mutate(hinctnt = hinctnt/12*10) # rescale to fit data from 2008 and 2010
ess_2004 = ess_2004 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrtha, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma, pdjobev, pdjobyr, emplrel, emplno, wrkctra, jbspv, wkdcorga, wkhtot, iscoco, tvpol, rdpol, nwsppol, uemp3m, uemp12m, uemp5yr, hinctnt, hincsrca, brwmny) %>%
  plyr::rename(c("cntbrtha"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
  ess_2004 = ess_2004 %>% mutate(hinctnt = hinctnt/12*10)
ess_2006 = ess_2006 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrtha, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma, pdjobev, pdjobyr, emplrel, emplno, wrkctra, jbspv, wkdcorga, wkhtot, iscoco, tvpol, rdpol, nwsppol, uemp3m, uemp12m, uemp5yr, hinctnt, hincsrca, brwmny) %>%
  plyr::rename(c("cntbrtha"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn"))
  ess_2006 = ess_2006 %>% mutate(hinctnt = hinctnt/12*10)
ess_2008 = ess_2008 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecntr, cntbrthb, gndr, edulvla, facntr, mocntr, polintr, polcmpl, poldcs, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghoma, pdjobev, pdjobyr, emplrel, emplno, wrkctra, jbspv, wkdcorga, wkhtot, iscoco, tvpol, rdpol, nwsppol, uemp3m, uemp12m, uemp5yr, hinctnta, hincsrca, brwmny) %>%
  plyr::rename(c("cntbrthb"="birthplace","blgetmg"="ethnic", "edulvla"="edu","brncntr"="fborn", "hinctnta" = "hinctnt"))
ess_2010 = ess_2010 %>%
  select(essround, cntry, agea, blgetmg, brncntr, ctzcntr, livecnta, cntbrthb, gndr, edulvlb, facntr, mocntr, polintr, hincfel, uempla, ppltrst, pplfair, pplhlp, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stflife, stfeco, stfgov, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, lnghom1, pdjobev, pdjobyr, emplrel, emplno, wrkctra, jbspv, wkdcorga, wkhtot, iscoco, tvpol, rdpol, nwsppol, uemp3m, uemp12m, uemp5yr, hinctnta, hincsrca, brwmny) %>%
  plyr::rename(c("cntbrthb"="birthplace","blgetmg"="ethnic", "edulvlb"="edu","livecnta" = "livecntr","brncntr"="fborn", "lnghom1"="lnghoma", "hinctnta" = "hinctnt"))
ess_2010$livecntr = ess_2010$livecntr - 2010
ess_2010$livecntr = ifelse(ess_2010$livecntr >= 1, 1,
                           ifelse(ess_2010$livecntr %in% c(-1:-5), 2,
                                  ifelse(ess_2010$livecntr %in% c(-6:-10), 3,
                                         ifelse(ess_2010$livecntr %in% c(-11:-20), 4,
                                                ifelse(ess_2010$livecntr < -20, 5, NA)))))
ess_2010$polcmpl = NA
ess_2010$poldcs = NA
```

```{r ess_civix, echo=TRUE, message=FALSE, warning=FALSE}
ess_raw = rbind(ess_2002, ess_2004, ess_2006, ess_2008, ess_2010)
ess_raw$sec.immi = ifelse(ess_raw$facntr == 2 | ess_raw$mocntr == 2, 1, 0)
ess_raw$ethnic = ifelse(ess_raw$ethnic == 1, 1,
                        ifelse(ess_raw$ethnic == 2, 0, NA))
ess_raw$citizen = ifelse(ess_raw$ctzcntr == 1, 1,
                         ifelse(ess_raw$ctzcntr == 2, 0, NA))
ess_raw$residence = ifelse(ess_raw$livecntr <= 3, 1, 0) # 1 = lived less than 10 yrs, 0 = lived more than 10 yrs
ess_raw$birthplace = ifelse(ess_raw$birthplace %in% c(66,77,88,99,"02","03","04","06"), NA, ess_raw$birthplace)
  # ess_raw = ess_raw[complete.cases(ess_raw$birthplace),]
  eu_member = c("BE", "FR", "DE", "IT", "LU", "NL", "DK", "IE", "GB", "GR", "PT", "ES","AT","SE")
  ess_raw$eubirth = ifelse(ess_raw$birthplace %in% eu_member, 1, 0)
ess_raw$female = ifelse(ess_raw$gndr == 2, 1, 
                        ifelse(ess_raw$gndr == 1, 0, NA))
ess_raw$edu = ifelse(ess_raw$edu > 5, NA, ess_raw$edu)
ess_raw$fborn = ifelse(ess_raw$fborn == 1, 0, 1) # now 1 as foreign born, 0 as native born

ess_raw$polintr = ifelse(ess_raw$polintr > 4, NA, ess_raw$polintr)
# table(ess_raw$polcmpl) whether politics are too complicated to understand, 5 as always, 1 as never
# table(ess_raw$poldcs) how difficult it is to make mind up about political issues, 5 as very easy, 1 as very difficult
ess_raw$poldcs = ifelse(ess_raw$poldcs == 5, 1, 
                        ifelse(ess_raw$poldcs == 4, 2, 
                               ifelse(ess_raw$poldcs == 3, 3, 
                                      ifelse(ess_raw$poldcs == 2, 4, 
                                             ifelse(ess_raw$poldcs == 1, 5, ess_raw$poldcs)))))
ess_raw$hincfel = ifelse(ess_raw$hincfel > 4, NA, ess_raw$hincfel)
ess_raw$ppltrst = ifelse(ess_raw$ppltrst > 10, NA, ess_raw$ppltrst) # 0 as can't be too careful, 10 as most people can be trusted
ess_raw$pplfair = ifelse(ess_raw$pplfair > 10, NA, ess_raw$pplfair) # 0 as most people take advantage, 10 as most people are fair
ess_raw$employ = ifelse(ess_raw$uempla == 0, 1, 0) # 1 = employed, 0 = unemployed

```

```{r citizen mean, message=FALSE, warning=FALSE}
ess_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry,polintr, hincfel, employ, ppltrst, pplfair, polcmpl, poldcs) %>%
  summarise(mean.poli = mean(polintr, na.rm = TRUE),
            mean.employ = mean(employ, na.rm = TRUE),
            mean.hincfel = mean(hincfel, na.rm = TRUE),
            mean.ppltrst = mean(ppltrst, na.rm = TRUE),
            mean.pplfair = mean(pplfair, na.rm = TRUE),
            mean.polcmpl = mean(polcmpl, na.rm = TRUE),
            mean.poldcs = mean(poldcs, na.rm = TRUE))

# ess_mean = ess_raw %>% filter(citizen == 1) %>% group_by(cntry) %>% 
#   select(cntry,polintr, hincfel, employ, ppltrst, pplfair) %>%
#   summarise(mean.poli = mean(polintr, na.rm = TRUE),
#             mean.employ = mean(employ, na.rm = TRUE),
#             mean.hincfel = mean(hincfel, na.rm = TRUE),
#             mean.ppltrst = mean(ppltrst, na.rm = TRUE),
#             mean.pplfair = mean(pplfair, na.rm = TRUE))
# 
# ess_mean.comp = ess_mean %>% left_join(ess_mean.1, by='cntry')


ess_tenyr = ess_raw %>% filter(residence == 1)

ess_tenyr = ess_tenyr %>% left_join(ess_mean, by='cntry')

ess_h.tenyr = ess_tenyr %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.tenyr = ess_tenyr %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

```

```{r ess_gap, echo=TRUE, message=FALSE, warning=FALSE}



ess_h.tenyr = ess_h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_l.tenyr = ess_l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )


```




# Descriptive Analysis: Replicating Goodman and Wright (2015) with different definition of `immigrants'

```{r noncitizen, message=FALSE, warning=FALSE}
ess_nonciti = ess_raw %>% filter(citizen == 0)

ess_nonciti = ess_nonciti %>% left_join(ess_mean, by='cntry')

ess_h.nonciti = ess_nonciti %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.nonciti = ess_nonciti %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

ess_h.nonciti = ess_h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_l.nonciti = ess_l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

```{r}
ess_fborn = ess_raw %>% filter(fborn == 1) 
ess_fborn = ess_fborn %>% left_join(ess_mean, by='cntry')

ess_h.fborn = ess_fborn %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ess_l.fborn = ess_fborn %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

ess_l.fborn = ess_l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

ess_h.fborn = ess_h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

```


## Noncitizens in ESS

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(hincfel.h.1$residuals) 1698

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(employ.h.1$residuals) 1813
# length(employ.l.1$residuals) 2673

employ.dat.h = with(ess_h.nonciti, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = employ.h.1 %>% 
  broom::augment(newdata = employ.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

employ.dat.l = with(ess_l.nonciti, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = employ.l.1 %>% 
  broom::augment(newdata = employ.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

# absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
# absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX among Non-citizens', fig.height=1.5, include=FALSE}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1804
# length(ppltrst.l.1$residuals) 1657

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15 among Non-citizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Less than 10-years of residence

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

# absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
# absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

employ.dat.h = with(ess_h.tenyr, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = employ.h.1 %>% 
  broom::augment(newdata = employ.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

employ.dat.l = with(ess_l.tenyr, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = employ.l.1 %>% 
  broom::augment(newdata = employ.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Foreign borns

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in EU-15, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in EU-15, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in EU-15, foreign-borns', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(hincfel.h.1$residuals) 4101
# length(hincfel.l.1$residuals) 4379

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in EU-15, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(employ.h.1$residuals)
# length(employ.l.1$residuals)

# absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
# absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

employ.dat.h = with(ess_h.fborn, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = employ.h.1 %>% 
  broom::augment(newdata = employ.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

employ.dat.l = with(ess_l.fborn, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = employ.l.1 %>% 
  broom::augment(newdata = employ.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

# length(ppltrst.h.1$residuals) 4388
# length(ppltrst.l.1$residuals) 4398

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in EU-15, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in EU-15, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

## Thinking about birthright citizenship

```{r birthright, echo=TRUE, message=FALSE, warning=FALSE}
list.cntry = as.vector(unique(ess_raw$cntry))
birthright = c("GB", "PT", "DE", "BE", "DK", "FR", "NL")
no.birthright = list.cntry[!list.cntry %in% birthright]

h.civix = c("DK", "NL", "DE", "AT", "FR", "GB", "GR")
l.civix = c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT")

```

### With birthright citizenship

```{r}
b.h = birthright[birthright %in% h.civix]
b.l = birthright[birthright %in% l.civix]

dat.b.h = ess_raw %>% filter(cntry %in% b.h)
dat.b.h = dat.b.h %>% left_join(ess_mean, by='cntry')
dat.b.l = ess_raw %>% filter(cntry %in% b.l)
dat.b.l = dat.b.l %>% left_join(ess_mean, by='cntry')

dat.b.h.nonciti = dat.b.h %>% filter(citizen == 0)
dat.b.h.tenyr = dat.b.h %>% filter(residence == 1)
dat.b.h.fborn = dat.b.h %>% filter(fborn == 1) 

dat.b.l.nonciti = dat.b.l %>% filter(citizen == 0)
dat.b.l.tenyr = dat.b.l %>% filter(residence == 1)
dat.b.l.fborn = dat.b.l %>% filter(fborn == 1) 

dat.b.h.nonciti = dat.b.h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.nonciti = dat.b.l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.h.tenyr = dat.b.h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.tenyr = dat.b.l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.h.fborn = dat.b.h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.b.l.fborn = dat.b.l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

# absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
# absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

employ.dat.h = with(ess_h.tenyr, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = employ.h.1 %>% 
  broom::augment(newdata = employ.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

employ.dat.l = with(ess_l.tenyr, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = employ.l.1 %>% 
  broom::augment(newdata = employ.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = ess_l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



#### Non-citizens



```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, noncitizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



#### Foreign-borns


```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries with birthright citizenship, foreign-brons', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.b.l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries with birthright citizenship, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



### W/o birthright citizenship

```{r}
n.b.h = no.birthright[no.birthright %in% h.civix]
n.b.l = no.birthright[no.birthright %in% l.civix]

dat.n.b.h = ess_raw %>% filter(cntry %in% n.b.h)
dat.n.b.h = dat.n.b.h %>% left_join(ess_mean, by='cntry')
dat.n.b.l = ess_raw %>% filter(cntry %in% n.b.l)
dat.n.b.l = dat.n.b.l %>% left_join(ess_mean, by='cntry')

dat.n.b.h.nonciti = dat.n.b.h %>% filter(citizen == 0)
dat.n.b.h.tenyr = dat.n.b.h %>% filter(residence == 1)
dat.n.b.h.fborn = dat.n.b.h %>% filter(fborn == 1) 

dat.n.b.l.nonciti = dat.n.b.l %>% filter(citizen == 0)
dat.n.b.l.tenyr = dat.n.b.l %>% filter(residence == 1)
dat.n.b.l.fborn = dat.n.b.l %>% filter(fborn == 1) 

dat.n.b.h.nonciti = dat.n.b.h.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.nonciti = dat.n.b.l.nonciti %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.h.tenyr = dat.n.b.h.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.tenyr = dat.n.b.l.tenyr %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.h.fborn = dat.n.b.h.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )

dat.n.b.l.fborn = dat.n.b.l.fborn %>% mutate(
  poli.gap = polintr - mean.poli, 
  employ.gap = employ - mean.employ,
  hincfel.gap = hincfel - mean.hincfel, 
  ppltrst.gap = ppltrst - mean.ppltrst,
  pplfair.gap = pplfair - mean.pplfair, 
  polcmpl.gap = polcmpl - mean.polcmpl,
  poldcs.gap = poldcs - mean.poldcs
  )
```

#### Ten-year residence

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.tenyr) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.tenyr) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, < 10 yrs', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

#### Non-citizens

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.nonciti) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.nonciti) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, noncitizens', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

#### Foreign-borns

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polintr.h.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
polintr.h.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
polintr.l.1 = lm(polintr ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
polintr.l.2 = lm(poli.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

absolute.h = as.vector(c(polintr.h.1$coefficients[1],confint(polintr.h.1)[1,]))
absolute.l = as.vector(c(polintr.l.1$coefficients[1],confint(polintr.l.1)[1,]))

gap.h = as.vector(c(polintr.h.2$coefficients[1],confint(polintr.h.2)[1,]))
gap.l = as.vector(c(polintr.l.2$coefficients[1],confint(polintr.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Political interests by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

polintr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polintr.1) = c("intercept", "min", "max")
polintr.1 = polintr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polintr.1$var = factor(polintr.1$var, as.character(polintr.1$var))

ggplot(polintr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
polcmpl.h.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
polcmpl.h.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
polcmpl.l.1 = lm(polcmpl ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
polcmpl.l.2 = lm(polcmpl.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(polcmpl.h.1$coefficients[1],confint(polcmpl.h.1)[1,]))
absolute.l = as.vector(c(polcmpl.l.1$coefficients[1],confint(polcmpl.l.1)[1,]))

gap.h = as.vector(c(polcmpl.h.2$coefficients[1],confint(polcmpl.h.2)[1,]))
gap.l = as.vector(c(polcmpl.l.2$coefficients[1],confint(polcmpl.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Politics as complicated by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

polcmpl.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(polcmpl.1) = c("intercept", "min", "max")
polcmpl.1 = polcmpl.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
polcmpl.1$var = factor(polcmpl.1$var, as.character(polcmpl.1$var))

ggplot(polcmpl.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
poldcs.h.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
poldcs.h.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
poldcs.l.1 = lm(poldcs ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
poldcs.l.2 = lm(poldcs.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(polintr.h.1$residuals) 1803
# length(polintr.h.2$residuals) 1803
# length(polintr.l.1$residuals) 2659

absolute.h = as.vector(c(poldcs.h.1$coefficients[1],confint(poldcs.h.1)[1,]))
absolute.l = as.vector(c(poldcs.l.1$coefficients[1],confint(poldcs.l.1)[1,]))

gap.h = as.vector(c(poldcs.h.2$coefficients[1],confint(poldcs.h.2)[1,]))
gap.l = as.vector(c(poldcs.l.2$coefficients[1],confint(poldcs.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Difficulties in making political decisions by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

poldcs.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(poldcs.1) = c("intercept", "min", "max")
poldcs.1 = poldcs.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
poldcs.1$var = factor(poldcs.1$var, as.character(poldcs.1$var))

ggplot(poldcs.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
hincfel.h.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
hincfel.h.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
hincfel.l.1 = lm(hincfel ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
hincfel.l.2 = lm(hincfel.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(hincfel.h.1$residuals) 1187
# length(hincfel.l.1$residuals) 1622

absolute.h = as.vector(c(hincfel.h.1$coefficients[1],confint(hincfel.h.1)[1,]))
absolute.l = as.vector(c(hincfel.l.1$coefficients[1],confint(hincfel.l.1)[1,]))

gap.h = as.vector(c(hincfel.h.2$coefficients[1],confint(hincfel.h.2)[1,]))
gap.l = as.vector(c(hincfel.l.2$coefficients[1],confint(hincfel.l.2)[1,]))
```



```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Financial situation by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

hincfel.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hincfel.1) = c("intercept", "min", "max")
hincfel.1 = hincfel.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hincfel.1$var = factor(hincfel.1$var, as.character(hincfel.1$var))

ggplot(hincfel.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, message=FALSE, warning=FALSE}
employ.h.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn, family = binomial(link = "logit")) # absolute level
employ.h.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
employ.l.1 = glm(employ ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn, family = binomial(link = "logit")) # absolute level
employ.l.2 = lm(employ.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(employ.h.1$residuals) 1238
# length(employ.l.1$residuals) 1646

absolute.h = as.vector(c(employ.h.1$coefficients[1],confint(employ.h.1)[1,]))
absolute.l = as.vector(c(employ.l.1$coefficients[1],confint(employ.l.1)[1,]))

gap.h = as.vector(c(employ.h.2$coefficients[1],confint(employ.h.2)[1,]))
gap.l = as.vector(c(employ.l.2$coefficients[1],confint(employ.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='Employment by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}
employ.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(employ.1) = c("intercept", "min", "max")
employ.1 = employ.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
employ.1$var = factor(employ.1$var, as.character(employ.1$var))

ggplot(employ.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r, echo=TRUE, message=FALSE, warning=FALSE}
ppltrst.h.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
ppltrst.h.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
ppltrst.l.1 = lm(ppltrst ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
ppltrst.l.2 = lm(ppltrst.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

# length(ppltrst.h.1$residuals) 1231
# length(ppltrst.l.1$residuals) 1632

absolute.h = as.vector(c(ppltrst.h.1$coefficients[1],confint(ppltrst.h.1)[1,]))
absolute.l = as.vector(c(ppltrst.l.1$coefficients[1],confint(ppltrst.l.1)[1,]))

gap.h = as.vector(c(ppltrst.h.2$coefficients[1],confint(ppltrst.h.2)[1,]))
gap.l = as.vector(c(ppltrst.l.2$coefficients[1],confint(ppltrst.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='General trust by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

ppltrst.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(ppltrst.1) = c("intercept", "min", "max")
ppltrst.1 = ppltrst.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
ppltrst.1$var = factor(ppltrst.1$var, as.character(ppltrst.1$var))

ggplot(ppltrst.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```

```{r, echo=TRUE, message=FALSE, warning=FALSE}
pplfair.h.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # absolute level
pplfair.h.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.h.fborn) # gap
pplfair.l.1 = lm(pplfair ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # absolute level
pplfair.l.2 = lm(pplfair.gap ~ agea + ethnic + female + edu + eubirth, data = dat.n.b.l.fborn) # gap

absolute.h = as.vector(c(pplfair.h.1$coefficients[1],confint(pplfair.h.1)[1,]))
absolute.l = as.vector(c(pplfair.l.1$coefficients[1],confint(pplfair.l.1)[1,]))

gap.h = as.vector(c(pplfair.h.2$coefficients[1],confint(pplfair.h.2)[1,]))
gap.l = as.vector(c(pplfair.l.2$coefficients[1],confint(pplfair.l.2)[1,]))
```

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.cap='People being fair by CIVIX in countries w/o birthright citizenship, foreign-borns', fig.height=1.5}

pplfair.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplfair.1) = c("intercept", "min", "max")
pplfair.1 = pplfair.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplfair.1$var = factor(pplfair.1$var, as.character(pplfair.1$var))

ggplot(pplfair.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```









# Testing different DVs

## Political Incorporation
```{r new dvs for poli incop, message=FALSE, warning=FALSE}

# ess_raw$tvpol # TV watching news/politics/current affairs on average weekday

# ess_raw$rdpol # Radio listening, news/politics/current affairs on average weekday

# ess_raw$nwsppol # Newspaper reading, politics/current affairs on average weekday

# ess_raw$contplt # Contacted politician or government official last 12 months

# ess_raw$wrkprty # Worked in political party or action group last 12 months
# 
# ess_raw$wrkorg # Worked in another organisation or association last 12 months
# 
# ess_raw$badge # Worn or displayed campaign badge/sticker last 12 months
# 
# ess_raw$sgnptit # Signed petition last 12 months
# 
# ess_raw$pbldmn # Taken part in lawful public demonstration last 12 months
# 
# ess_raw$bctprd # Boycotted certain products last 12 months

## ess_raw$dntmny # Donated money to political organisation or group last 12 months

## ess_raw$ilglpst # Participated illegal protest activities last 12 months

# ess_raw$stfgov # How satisfied with the national government

ess_raw$tvpol = ifelse(ess_raw$tvpol > 8, NA, ess_raw$tvpol)
ess_raw$rdpol = ifelse(ess_raw$rdpol > 8, NA, ess_raw$rdpol)
ess_raw$nwsppol = ifelse(ess_raw$nwsppol > 8, NA, ess_raw$nwsppol)

ess_raw$contplt = ifelse(ess_raw$contplt == 2, 0, ess_raw$contplt)
ess_raw$wrkprty = ifelse(ess_raw$wrkprty == 2, 0, ess_raw$wrkprty)
ess_raw$wrkorg = ifelse(ess_raw$wrkorg == 2, 0, ess_raw$wrkorg)
ess_raw$badge = ifelse(ess_raw$badge == 2, 0, ess_raw$badge)
ess_raw$sgnptit = ifelse(ess_raw$sgnptit == 2, 0, ess_raw$sgnptit)
ess_raw$pbldmn = ifelse(ess_raw$pbldmn == 2, 0, ess_raw$pbldmn)
ess_raw$bctprd = ifelse(ess_raw$bctprd == 2, 0, ess_raw$bctprd)

pol_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry, contplt, wrkprty, wrkorg, badge, sgnptit, pbldmn, bctprd, stfgov, tvpol, rdpol, nwsppol) %>%
  summarise(mean.contplt = mean(contplt, na.rm = TRUE),
            mean.wrkprty = mean(wrkprty, na.rm = TRUE),
            mean.wrkorg = mean(wrkorg, na.rm = TRUE),
            mean.badge = mean(badge, na.rm = TRUE),
            mean.sgnptit = mean(sgnptit, na.rm = TRUE),
            mean.pbldmn = mean(pbldmn, na.rm = TRUE),
            mean.bctprd = mean(bctprd, na.rm = TRUE),
            # mean.dntmny = mean(dntmny, na.rm = TRUE),
            # mean.ilglpst = mean(ilglpst, na.rm = TRUE),
            mean.stfgov = mean(stfgov, na.rm = TRUE),
            mean.tvpol = mean(tvpol, na.rm = TRUE),
            mean.rdpol = mean(rdpol, na.rm = TRUE),
            mean.nwsppol = mean(nwsppol, na.rm = TRUE))

ess_pol = ess_raw %>% filter(residence == 1)
ess_pol = ess_pol %>% left_join(pol_mean, by='cntry')

pol_h = ess_pol %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
pol_l = ess_pol %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

pol_h = pol_h %>%  mutate(
  contplt.gap = contplt - mean.contplt, 
  wrkprty.gap = wrkprty - mean.wrkprty,
  wrkorg.gap = wrkorg - mean.wrkorg, 
  badge.gap = badge - mean.badge,
  sgnptit.gap = sgnptit - mean.sgnptit, 
  pbldmn.gap = pbldmn - mean.pbldmn,
  bctprd.gap = bctprd - mean.bctprd,
  stfgov.gap = stfgov - mean.stfgov, 
  tvpol.gap = tvpol - mean.tvpol,
  rdpol.gap = rdpol - mean.rdpol,
  nwsppol.gap = nwsppol - mean.nwsppol
  )

pol_l = pol_l %>%  mutate(
  contplt.gap = contplt - mean.contplt, 
  wrkprty.gap = wrkprty - mean.wrkprty,
  wrkorg.gap = wrkorg - mean.wrkorg, 
  badge.gap = badge - mean.badge,
  sgnptit.gap = sgnptit - mean.sgnptit, 
  pbldmn.gap = pbldmn - mean.pbldmn,
  bctprd.gap = bctprd - mean.bctprd,
  stfgov.gap = stfgov - mean.stfgov, 
  tvpol.gap = tvpol - mean.tvpol,
  rdpol.gap = rdpol - mean.rdpol,
  nwsppol.gap = nwsppol - mean.nwsppol
  )
```

## Using Goodman and Wright's methods

```{r contplt model, fig.height=1.5, fig.cap='Contacted politician or government official last 12 months'}

pol.h.1 = glm(contplt ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
pol.h.2 = lm(contplt.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
pol.l.1 = glm(contplt ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
pol.l.2 = lm(contplt.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(pol.h.1$coefficients[1],confint(pol.h.1)[1,]))
# absolute.l = as.vector(c(pol.l.1$coefficients[1],confint(pol.l.1)[1,]))

pol.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = pol.h.1 %>% 
  broom::augment(newdata = pol.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

pol.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = pol.l.1 %>% 
  broom::augment(newdata = pol.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(pol.h.2$coefficients[1],confint(pol.h.2)[1,]))
gap.l = as.vector(c(pol.l.2$coefficients[1],confint(pol.l.2)[1,]))

contplt.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(contplt.1) = c("intercept", "min", "max")
contplt.1 = contplt.1 %>%mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
contplt.1$var = factor(contplt.1$var, as.character(contplt.1$var))

ggplot(contplt.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-3, 3)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


```{r wrkprty model, fig.height=1.5, fig.cap='Worked in political party or action group last 12 months'}
wrkprty.h.1 = glm(wrkprty ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
wrkprty.h.2 = lm(wrkprty.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
wrkprty.l.1 = glm(wrkprty ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
wrkprty.l.2 = lm(wrkprty.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(wrkprty.h.1$coefficients[1],confint(wrkprty.h.1)[1,]))
# absolute.l = as.vector(c(wrkprty.l.1$coefficients[1],confint(wrkprty.l.1)[1,]))

wrkprty.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = wrkprty.h.1 %>% 
  broom::augment(newdata = wrkprty.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

wrkprty.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = wrkprty.l.1 %>% 
  broom::augment(newdata = wrkprty.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(wrkprty.h.2$coefficients[1],confint(wrkprty.h.2)[1,]))
gap.l = as.vector(c(wrkprty.l.2$coefficients[1],confint(wrkprty.l.2)[1,]))

wrkprty.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wrkprty.1) = c("intercept", "min", "max")
wrkprty.1 = wrkprty.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wrkprty.1$var = factor(wrkprty.1$var, as.character(wrkprty.1$var))

ggplot(wrkprty.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r wrkorg model, fig.height=1.5, fig.cap='Worked in another organisation or association last 12 months'}
wrkorg.h.1 = glm(wrkorg ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
wrkorg.h.2 = lm(wrkorg.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
wrkorg.l.1 = glm(wrkorg ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
wrkorg.l.2 = lm(wrkorg.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(wrkorg.h.1$coefficients[1],confint(wrkorg.h.1)[1,]))
# absolute.l = as.vector(c(wrkorg.l.1$coefficients[1],confint(wrkorg.l.1)[1,]))

wrkorg.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = wrkorg.h.1 %>% 
  broom::augment(newdata = wrkorg.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

wrkorg.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = wrkorg.l.1 %>% 
  broom::augment(newdata = wrkorg.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(wrkorg.h.2$coefficients[1],confint(wrkorg.h.2)[1,]))
gap.l = as.vector(c(wrkorg.l.2$coefficients[1],confint(wrkorg.l.2)[1,]))

wrkorg.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wrkorg.1) = c("intercept", "min", "max")
wrkorg.1 = wrkorg.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wrkorg.1$var = factor(wrkorg.1$var, as.character(wrkorg.1$var))

ggplot(wrkorg.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-3, 3)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r badge model, fig.height=1.5, fig.cap='Whether have worn or displayed campaign badge/sticker last 12 months'}

badge.h.1 = glm(badge ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
badge.h.2 = lm(badge.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
badge.l.1 = glm(badge ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
badge.l.2 = lm(badge.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(badge.h.1$coefficients[1],confint(badge.h.1)[1,]))
# absolute.l = as.vector(c(badge.l.1$coefficients[1],confint(badge.l.1)[1,]))

badge.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = badge.h.1 %>% 
  broom::augment(newdata = badge.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

badge.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = badge.l.1 %>% 
  broom::augment(newdata = badge.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(badge.h.2$coefficients[1],confint(badge.h.2)[1,]))
gap.l = as.vector(c(badge.l.2$coefficients[1],confint(badge.l.2)[1,]))

badge.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(badge.1) = c("intercept", "min", "max")
badge.1 = badge.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
badge.1$var = factor(badge.1$var, as.character(badge.1$var))

ggplot(badge.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-4, 4)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r sgnptit model, fig.height=1.5, fig.cap='Whether signed petition last 12 months'}

sgnptit.h.1 = glm(sgnptit ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
sgnptit.h.2 = lm(sgnptit.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
sgnptit.l.1 = glm(sgnptit ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
sgnptit.l.2 = lm(sgnptit.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(sgnptit.h.1$coefficients[1],confint(sgnptit.h.1)[1,]))
# absolute.l = as.vector(c(sgnptit.l.1$coefficients[1],confint(sgnptit.l.1)[1,]))

sgnptit.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = sgnptit.h.1 %>% 
  broom::augment(newdata = sgnptit.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

sgnptit.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = sgnptit.l.1 %>% 
  broom::augment(newdata = sgnptit.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(sgnptit.h.2$coefficients[1],confint(sgnptit.h.2)[1,]))
gap.l = as.vector(c(sgnptit.l.2$coefficients[1],confint(sgnptit.l.2)[1,]))

sgnptit.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(sgnptit.1) = c("intercept", "min", "max")
sgnptit.1 = sgnptit.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
sgnptit.1$var = factor(sgnptit.1$var, as.character(sgnptit.1$var))

ggplot(sgnptit.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2.5, 2.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r pbldmn model, fig.height=1.5, fig.cap='Whether taken part in lawful public demonstration last 12 months'}
pbldmn.h.1 = glm(pbldmn ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
pbldmn.h.2 = lm(pbldmn.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
pbldmn.l.1 = glm(pbldmn ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
pbldmn.l.2 = lm(pbldmn.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(pbldmn.h.1$coefficients[1],confint(pbldmn.h.1)[1,]))
# absolute.l = as.vector(c(pbldmn.l.1$coefficients[1],confint(pbldmn.l.1)[1,]))

pbldmn.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = pbldmn.h.1 %>% 
  broom::augment(newdata = pbldmn.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

pbldmn.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = pbldmn.l.1 %>% 
  broom::augment(newdata = pbldmn.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(pbldmn.h.2$coefficients[1],confint(pbldmn.h.2)[1,]))
gap.l = as.vector(c(pbldmn.l.2$coefficients[1],confint(pbldmn.l.2)[1,]))

pbldmn.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pbldmn.1) = c("intercept", "min", "max")
pbldmn.1 = pbldmn.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pbldmn.1$var = factor(pbldmn.1$var, as.character(pbldmn.1$var))

ggplot(pbldmn.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-4, 4)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r bctprd model, fig.height=1.5, fig.cap='Whether boycotted certain products last 12 months'}
bctprd.h.1 = glm(bctprd ~ agea + ethnic + female + edu + eubirth, data = pol_h, family = "binomial") # absolute level
bctprd.h.2 = lm(bctprd.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
bctprd.l.1 = glm(bctprd ~ agea + ethnic + female + edu + eubirth, data = pol_l, family = "binomial") # absolute level
bctprd.l.2 = lm(bctprd.gap ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

# absolute.h = as.vector(c(bctprd.h.1$coefficients[1],confint(bctprd.h.1)[1,]))
# absolute.l = as.vector(c(bctprd.l.1$coefficients[1],confint(bctprd.l.1)[1,]))

bctprd.dat.h = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = bctprd.h.1 %>% 
  broom::augment(newdata = bctprd.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

bctprd.dat.l = with(pol_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = bctprd.l.1 %>% 
  broom::augment(newdata = bctprd.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(bctprd.h.2$coefficients[1],confint(bctprd.h.2)[1,]))
gap.l = as.vector(c(bctprd.l.2$coefficients[1],confint(bctprd.l.2)[1,]))

bctprd.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(bctprd.1) = c("intercept", "min", "max")
bctprd.1 = bctprd.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
bctprd.1$var = factor(bctprd.1$var, as.character(bctprd.1$var))

ggplot(bctprd.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-3, 3)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r stfgov model, fig.height=1.5, fig.cap='How satisfied with the national government'}
stfgov.h.1 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
stfgov.h.2 = lm(stfgov.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
stfgov.l.1 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
stfgov.l.2 = lm(stfgov ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(stfgov.h.1$coefficients[1],confint(stfgov.h.1)[1,]))
absolute.l = as.vector(c(stfgov.l.1$coefficients[1],confint(stfgov.l.1)[1,]))

gap.h = as.vector(c(stfgov.h.2$coefficients[1],confint(stfgov.h.2)[1,]))
gap.l = as.vector(c(stfgov.l.2$coefficients[1],confint(stfgov.l.2)[1,]))

stfgov.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(stfgov.1) = c("intercept", "min", "max")
stfgov.1 = stfgov.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
stfgov.1$var = factor(stfgov.1$var, as.character(stfgov.1$var))

ggplot(stfgov.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r tvpol model, fig.height=1.5, fig.cap='How much of your time watching television is spent watching news or programmes about politics? (0 to 3 hours or more)'}
tvpol.h.1 = lm(tvpol ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
tvpol.h.2 = lm(tvpol.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
tvpol.l.1 = lm(tvpol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
tvpol.l.2 = lm(tvpol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(tvpol.h.1$coefficients[1],confint(tvpol.h.1)[1,]))
absolute.l = as.vector(c(tvpol.l.1$coefficients[1],confint(tvpol.l.1)[1,]))

gap.h = as.vector(c(tvpol.h.2$coefficients[1],confint(tvpol.h.2)[1,]))
gap.l = as.vector(c(tvpol.l.2$coefficients[1],confint(tvpol.l.2)[1,]))

tvpol.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(tvpol.1) = c("intercept", "min", "max")
tvpol.1 = tvpol.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
tvpol.1$var = factor(tvpol.1$var, as.character(tvpol.1$var))

ggplot(tvpol.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1.5, 1.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")+ 
  xlab("Time spent watching TV about politics (intercept)")
```

```{r rdpol model, fig.height=1.5, fig.cap='How much of your time listening to the radio is spent listening to news or programmes about politics? (0 to 3 hours or more)'}
rdpol.h.1 = lm(rdpol ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
rdpol.h.2 = lm(rdpol.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
rdpol.l.1 = lm(rdpol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
rdpol.l.2 = lm(rdpol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(rdpol.h.1$coefficients[1],confint(rdpol.h.1)[1,]))
absolute.l = as.vector(c(rdpol.l.1$coefficients[1],confint(rdpol.l.1)[1,]))

gap.h = as.vector(c(rdpol.h.2$coefficients[1],confint(rdpol.h.2)[1,]))
gap.l = as.vector(c(rdpol.l.2$coefficients[1],confint(rdpol.l.2)[1,]))

rdpol.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(rdpol.1) = c("intercept", "min", "max")
rdpol.1 = rdpol.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
rdpol.1$var = factor(rdpol.1$var, as.character(rdpol.1$var))

ggplot(rdpol.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1.5, 1.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")+ 
  xlab("Time spent listening to the radio about politics (intercept)")
```

```{r nwsppol model, fig.height=1.5, fig.cap='How much of your time reading newspapers is spent reading about about politics? (0 to 3 hours or more)'}
nwsppol.h.1 = lm(nwsppol ~ agea + ethnic + female + edu + eubirth, data = pol_h) # absolute level
nwsppol.h.2 = lm(nwsppol.gap ~ agea + ethnic + female + edu + eubirth, data = pol_h) # gap
nwsppol.l.1 = lm(nwsppol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # absolute level
nwsppol.l.2 = lm(nwsppol ~ agea + ethnic + female + edu + eubirth, data = pol_l) # gap

absolute.h = as.vector(c(nwsppol.h.1$coefficients[1],confint(nwsppol.h.1)[1,]))
absolute.l = as.vector(c(nwsppol.l.1$coefficients[1],confint(nwsppol.l.1)[1,]))

gap.h = as.vector(c(nwsppol.h.2$coefficients[1],confint(nwsppol.h.2)[1,]))
gap.l = as.vector(c(nwsppol.l.2$coefficients[1],confint(nwsppol.l.2)[1,]))

nwsppol.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(nwsppol.1) = c("intercept", "min", "max")
nwsppol.1 = nwsppol.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
nwsppol.1$var = factor(nwsppol.1$var, as.character(nwsppol.1$var))

ggplot(nwsppol.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1.5, 1.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Time spent reading newspapers about politics (intercept)")
```





## Social Incorporation


```{r socio incop, warning=FALSE, message=FALSE}
### social incorporation

# ess_raw$stflife # How satisfied with life as a whole
# 
# table(ess_raw$pplhlp) # Most of the time people helpful or mostly looking out for themselves (0: look out for themselves, 10: trying tobe helpful)
# 
# ess_raw$happy # How happy are you

## ess_raw$inmdisc # Anyone to discuss intimate and personal matters with

# ess_raw$aesfdrk # Feeling of safety of walking alone in local area after dark
# 
# ess_raw$health # Subjective general health
# 
# ess_raw$dscrgrp # Member of a group discriminated against in this country
# 
# ess_raw$dscrrce # Discrimination of respondent's group: colour or race
# 
# ess_raw$dscrntn # Discrimination of respondent's group: nationality
# 
# # ess_raw$dscretn # Discrimination of respondent's group: ethnic group
# 
# ess_raw$lnghoma # Language most often spoken at home: first mentioned *** COME BACK FOR THIS
# 
# ### citizen involvement
# 
# ess_raw$sptcptp # Sports/outdoor activity club, last 12 months: participated
# 
# ess_raw$cltoptp # Cultural/hobby activity organisation, last 12 months: participated
# 
# ess_raw$truptp # Trade union, last 12 months: participated
# 
# ess_raw$prfoptp # Business/profession/farmers organisation, last 12 months: participated
# 
# ess_raw$cnsoptp # Consumer/automobile organisation, last 12 months: participated
# 
# ess_raw$hmnoptp # Humanitarian organisation etc., last 12 months: participated
# 
# ess_raw$epaoptp # Environmental/peace/animal organisation, last 12 months: participated
# 
# ess_raw$rlgoptp # Religious/church organisation, last 12 months: participated
# 
# ess_raw$prtyptp # Political party, last 12 months: participated
# 
# ess_raw$setoptp # Science/education/teacher organisation, last 12 months: participated
# 
# ess_raw$sclcptp # Social club etc., last 12 months: participated
# 
# ess_raw$othvptp # Other voluntary organisation, last 12 months: participated

ess_raw$dscrgrp = ifelse(ess_raw$dscrgrp == 2, 0, ess_raw$dscrgrp) # 1 as yes, 0 as no

ess_raw = ess_raw %>% 
  filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR", "IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))  
  
main.lan.1 = ess_raw %>% group_by(cntry) %>% 
  filter(lnghoma != 999, lnghoma != 888, lnghoma != 777) %>% 
  summarise(main.lan.1 = tail(names(sort(table(lnghoma))),1))

main.lan.2 = ess_raw %>% group_by(cntry) %>% 
  filter(lnghoma != 999, lnghoma != 888, lnghoma != 777) %>% 
  summarise(main.lan.2 = tail(names(sort(table(lnghoma))),2)[1])

ess_raw = ess_raw %>% 
  left_join(main.lan.1, by = "cntry") %>% 
  left_join(main.lan.2, by = "cntry")

ess_raw = ess_raw %>% group_by(cntry) %>%
  mutate(main.lan = ifelse(lnghoma == main.lan.1 |lnghoma == main.lan.2 , 1, 0))
  # 1: speak majority language at home, 0: minority language

soc_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(cntry, stflife, pplhlp, happy, aesfdrk, health, dscrgrp, dscrrce, dscrntn, main.lan) %>%
  summarise(mean.stflife = mean(stflife, na.rm = TRUE),
            mean.pplhlp = mean(pplhlp, na.rm = TRUE),
            mean.happy = mean(happy, na.rm = TRUE),
            # mean.inmdisc = mean(inmdisc, na.rm = TRUE),
            mean.aesfdrk = mean(aesfdrk, na.rm = TRUE),
            mean.health = mean(health, na.rm = TRUE),
            mean.dscrgrp = mean(dscrgrp, na.rm = TRUE),
            mean.dscrrce = mean(dscrrce, na.rm = TRUE),
            mean.dscrntn = mean(dscrntn, na.rm = TRUE),
            mean.lan = mean(main.lan, na.rm = TRUE))
            # mean.dscretn = mean(dscretn, na.rm = TRUE),
            # mean.lnghoma = mean(lnghoma, na.rm = TRUE))
            # mean.sptcptp = mean(sptcptp, na.rm = TRUE),
            # mean.cltoptp = mean(cltoptp, na.rm = TRUE),
            # mean.truptp = mean(truptp, na.rm = TRUE),
            # mean.prfoptp = mean(prfoptp, na.rm = TRUE),
            # mean.cnsoptp = mean(cnsoptp, na.rm = TRUE),
            # mean.hmnoptp = mean(hmnoptp, na.rm = TRUE),
            # mean.epaoptp = mean(epaoptp, na.rm = TRUE),
            # mean.rlgoptp = mean(rlgoptp, na.rm = TRUE),
            # mean.prtyptp = mean(prtyptp, na.rm = TRUE),
            # mean.setoptp = mean(setoptp, na.rm = TRUE),
            # mean.sclcptp = mean(sclcptp, na.rm = TRUE),
            # mean.othvptp = mean(othvptp, na.rm = TRUE))

ess_soc = ess_raw %>% filter(residence == 1)
ess_soc = ess_soc %>% left_join(soc_mean, by='cntry')

soc_h = ess_soc %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
soc_l = ess_soc %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

soc_h = soc_h %>%  mutate(
  stflife.gap = stflife - mean.stflife, 
  pplhlp.gap = pplhlp - mean.pplhlp,
  happy.gap = happy - mean.happy,
  aesfdrk.gap = aesfdrk - mean.aesfdrk,
  health.gap = health - mean.health, 
  dscrgrp.gap = dscrgrp - mean.dscrgrp,
  dscrrce.gap = dscrrce - mean.dscrrce,
  dscrntn.gap = dscrntn - mean.dscrntn,
  lan.gap = main.lan - mean.lan
  # lnghoma.gap = lnghoma - mean.lnghoma
  )

soc_l = soc_l %>%  mutate(
  stflife.gap = stflife - mean.stflife, 
  pplhlp.gap = pplhlp - mean.pplhlp,
  happy.gap = happy - mean.happy,
  aesfdrk.gap = aesfdrk - mean.aesfdrk,
  health.gap = health - mean.health, 
  dscrgrp.gap = dscrgrp - mean.dscrgrp,
  dscrrce.gap = dscrrce - mean.dscrrce,
  dscrntn.gap = dscrntn - mean.dscrntn,
  lan.gap = main.lan - mean.lan 
  # lnghoma.gap = lnghoma - mean.lnghoma
  )

```

### Using Goodman and Wright's methods

```{r stflife model, fig.height=1.5, fig.cap='How satisfied with life as a whole'}
stflife.h.1 = lm(stflife ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
stflife.h.2 = lm(stflife.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
stflife.l.1 = lm(stflife ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
stflife.l.2 = lm(stflife.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(stflife.h.1$coefficients[1],confint(stflife.h.1)[1,]))
absolute.l = as.vector(c(stflife.l.1$coefficients[1],confint(stflife.l.1)[1,]))

gap.h = as.vector(c(stflife.h.2$coefficients[1],confint(stflife.h.2)[1,]))
gap.l = as.vector(c(stflife.l.2$coefficients[1],confint(stflife.l.2)[1,]))

stflife.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(stflife.1) = c("intercept", "min", "max")
stflife.1 = stflife.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
stflife.1$var = factor(stflife.1$var, as.character(stflife.1$var))

ggplot(stflife.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-7.5, 7.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```


```{r pplhlp model, fig.height=1.5, fig.cap='Most of the time people helpful (10) or mostly looking out for themselves (0)'}
pplhlp.h.1 = lm(pplhlp ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
pplhlp.h.2 = lm(pplhlp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
pplhlp.l.1 = lm(pplhlp ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
pplhlp.l.2 = lm(pplhlp.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(pplhlp.h.1$coefficients[1],confint(pplhlp.h.1)[1,]))
absolute.l = as.vector(c(pplhlp.l.1$coefficients[1],confint(pplhlp.l.1)[1,]))

gap.h = as.vector(c(pplhlp.h.2$coefficients[1],confint(pplhlp.h.2)[1,]))
gap.l = as.vector(c(pplhlp.l.2$coefficients[1],confint(pplhlp.l.2)[1,]))

pplhlp.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pplhlp.1) = c("intercept", "min", "max")
pplhlp.1 = pplhlp.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pplhlp.1$var = factor(pplhlp.1$var, as.character(pplhlp.1$var))

ggplot(pplhlp.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-7.5, 7.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r happy model, fig.height=1.5, fig.cap='How happy are you (0: exteremely unhappy, 10: extremely happy)'}
happy.h.1 = lm(happy ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
happy.h.2 = lm(happy.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
happy.l.1 = lm(happy ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
happy.l.2 = lm(happy.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(happy.h.1$coefficients[1],confint(happy.h.1)[1,]))
absolute.l = as.vector(c(happy.l.1$coefficients[1],confint(happy.l.1)[1,]))

gap.h = as.vector(c(happy.h.2$coefficients[1],confint(happy.h.2)[1,]))
gap.l = as.vector(c(happy.l.2$coefficients[1],confint(happy.l.2)[1,]))

happy.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(happy.1) = c("intercept", "min", "max")
happy.1 = happy.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
happy.1$var = factor(happy.1$var, as.character(happy.1$var))

ggplot(happy.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-10, 10)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r aesfdrk, fig.height=1.5, fig.cap='Feeling of safety of walking alone in local area after dark (1: very safe, 4: very unsafe)'}
aesfdrk.h.1 = lm(aesfdrk ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
aesfdrk.h.2 = lm(aesfdrk.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
aesfdrk.l.1 = lm(aesfdrk ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
aesfdrk.l.2 = lm(aesfdrk.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(aesfdrk.h.1$coefficients[1],confint(aesfdrk.h.1)[1,]))
absolute.l = as.vector(c(aesfdrk.l.1$coefficients[1],confint(aesfdrk.l.1)[1,]))

gap.h = as.vector(c(aesfdrk.h.2$coefficients[1],confint(aesfdrk.h.2)[1,]))
gap.l = as.vector(c(aesfdrk.l.2$coefficients[1],confint(aesfdrk.l.2)[1,]))

aesfdrk.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(aesfdrk.1) = c("intercept", "min", "max")
aesfdrk.1 = aesfdrk.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
aesfdrk.1$var = factor(aesfdrk.1$var, as.character(aesfdrk.1$var))

ggplot(aesfdrk.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-4, 4)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```


```{r health, fig.height=1.5, fig.cap='Subjective general health (1 very good, 5 very bad)'}
health.h.1 = lm(health ~ agea + ethnic + female + edu + eubirth, data = soc_h) # absolute level
health.h.2 = lm(health.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
health.l.1 = lm(health ~ agea + ethnic + female + edu + eubirth, data = soc_l) # absolute level
health.l.2 = lm(health.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

absolute.h = as.vector(c(health.h.1$coefficients[1],confint(health.h.1)[1,]))
absolute.l = as.vector(c(health.l.1$coefficients[1],confint(health.l.1)[1,]))

gap.h = as.vector(c(health.h.2$coefficients[1],confint(health.h.2)[1,]))
gap.l = as.vector(c(health.l.2$coefficients[1],confint(health.l.2)[1,]))

health.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(health.1) = c("intercept", "min", "max")
health.1 = health.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
health.1$var = factor(health.1$var, as.character(health.1$var))

ggplot(health.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r dscrgrp, fig.height=1.5, fig.cap='Whether a member of a group discriminated against in this country (1 yes)'}
dscrgrp.h.1 = glm(dscrgrp ~ agea + female + edu + eubirth, data = soc_h, family = 'binomial') # absolute level
dscrgrp.h.2 = lm(dscrgrp.gap ~ agea + female + edu + eubirth, data = soc_h) # gap
dscrgrp.l.1 = glm(dscrgrp ~ agea + female + edu + eubirth, data = soc_l, family = 'binomial') # absolute level
dscrgrp.l.2 = lm(dscrgrp.gap ~ agea + female + edu + eubirth, data = soc_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

dscrigrp.dat.h = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = dscrgrp.h.1 %>% 
  broom::augment(newdata = dscrigrp.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

dscrigrp.dat.l = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = dscrgrp.l.1 %>% 
  broom::augment(newdata = dscrigrp.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(dscrgrp.h.2$coefficients[1],confint(dscrgrp.h.2)[1,]))
gap.l = as.vector(c(dscrgrp.l.2$coefficients[1],confint(dscrgrp.l.2)[1,]))

dscrgrp.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(dscrgrp.1) = c("intercept", "min", "max")
dscrgrp.1 = dscrgrp.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
dscrgrp.1$var = factor(dscrgrp.1$var, as.character(dscrgrp.1$var))

ggplot(dscrgrp.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2, 2)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r language at home, fig.height=1.5, fig.cap='Language at home (1 for majority language)'}

lan.h.1 = glm(main.lan ~ agea + ethnic + female + edu + eubirth, data = soc_h, family = 'binomial') # absolute level
lan.h.2 = lm(lan.gap ~ agea + ethnic + female + edu + eubirth, data = soc_h) # gap
lan.l.1 = glm(main.lan ~ agea + ethnic + female + edu + eubirth, data = soc_l, family = 'binomial') # absolute level
lan.l.2 = lm(lan.gap ~ agea + ethnic + female + edu + eubirth, data = soc_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

lan.dat.h = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = lan.h.1 %>% 
  broom::augment(newdata = lan.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

lan.dat.l = with(soc_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = lan.l.1 %>% 
  broom::augment(newdata = lan.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(lan.h.2$coefficients[1],confint(lan.h.2)[1,]))
gap.l = as.vector(c(lan.l.2$coefficients[1],confint(lan.l.2)[1,]))

lan.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(lan.1) = c("intercept", "min", "max")
lan.1 = lan.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
lan.1$var = factor(lan.1$var, as.character(lan.1$var))

ggplot(lan.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")


```


### Playing with the models

```{r}

```


## Socio-economic incorporation

```{r socio incorporation, warning=FALSE, message=FALSE}

# pdjobev - Ever had a paid job
# pdjobyr - Year last in paid job
# emplrel - Employment relation
# emplno - Number of employees respondent has/had
# wrkctra - Employment contract unlimited or limited duration
# jbspv - Responsible for supervising other employees
# wkdcorga - Allowed to decide how daily work is organised
# wkhtot - Total hours normally worked per week in main job overtime included
# iscoco - Occupation, ISCO88 (com)
# uemp3m - Ever unemployed and seeking work for a period more than three months
# uemp12m - Any period of unemployment and work seeking lasted 12 months or more 
# uemp5yr - Any period of unemployment and work seeking within last 5 years

# hinctnta - Household's total net income, all sources

ess_raw$pdjobev = ifelse(ess_raw$pdjobev > 5, NA, 
                         ifelse(ess_raw$pdjobev == 2, 0, ess_raw$pdjobev)) # 1 as yes, 0 as no
ess_raw$pdjobyr = ifelse(ess_raw$pdjobyr > 2010, NA, ess_raw$pdjobyr)
essr = c(2002, 2004, 2006, 2008, 2010)
essround = c(1:5)
essround = as.data.frame(t(rbind(essr, essround)))
ess_raw = ess_raw %>% left_join(essround, by='essround')
ess_raw = ess_raw %>% mutate(pdjobyr = essr - pdjobyr)

ess_raw$self.emply = ifelse(ess_raw$emplrel == 1, 0, 
                            ifelse(ess_raw$emplrel == 2, 1, 
                                   ifelse(ess_raw$emplrel == 3, 1, NA))) # remember that there's no "gap with natives" in this question
ess_raw$wrkctr = ifelse(ess_raw$wrkctra == 1, 0,
                         ifelse(ess_raw$wrkctra == 2, 1, 
                                ifelse(ess_raw$wrkctra == 3, 1, NA))) # 1 as w/ limited contract or no contract at all, 0 as unlimited contract
ess_raw$contract = ifelse(ess_raw$wrkctra == 1, 1, 
                             ifelse(ess_raw$wrkctra == 2, 1, 
                                    ifelse(ess_raw$wrkctra == 3, 0, NA))) # 1 as with contract, 0 as w/o contract

ess_raw$jbspv = ifelse(ess_raw$jbspv == 2, 0, 
                       ifelse(ess_raw$jbspv == 1, 1, NA))

ess_raw$wkdcorga = ifelse(ess_raw$wkdcorga > 10, NA, ess_raw$wkdcorga)
ess_raw$wkhtot = ifelse(ess_raw$wkhtot > 168, NA, ess_raw$wkhtot)

iscoco.h.w = c(100:3500) # high skilled white collar
iscoco.l.w = c(4000:5500) # low skilled white collar
iscoco.h.b = c(6000:7500) # high skilled blue collar
iscoco.l.b = c(8000:9330) # low skilled blue collar
ess_raw$skill = ifelse(ess_raw$iscoco %in% iscoco.h.w, 1, 
                       ifelse(ess_raw$iscoco %in% iscoco.h.b, 1,
                              ifelse(ess_raw$iscoco %in% iscoco.l.w, 0,
                                     ifelse(ess_raw$iscoco %in% iscoco.l.b, 0, NA)))) # 1 as high skilled, 0 as low skilled

ess_raw$blue = ifelse(ess_raw$iscoco %in% iscoco.h.w, 0, 
                       ifelse(ess_raw$iscoco %in% iscoco.l.w, 0,
                              ifelse(ess_raw$iscoco %in% iscoco.h.b, 1,
                                     ifelse(ess_raw$iscoco %in% iscoco.l.b, 1, NA)))) # 1 as blue collar, 0 as white

ess_raw$uemp3m = ifelse(ess_raw$uemp3m == 2, 0, 
                        ifelse(ess_raw$uemp3m == 1, 1, NA))

ess_raw$uemp12m = ifelse(ess_raw$uemp12m == 2, 0, 
                        ifelse(ess_raw$uemp12m == 1, 1, NA))

ess_raw$uemp5yr = ifelse(ess_raw$uemp5yr == 2, 0, 
                        ifelse(ess_raw$uemp5yr == 1, 1, NA))

ess_raw$soc.welfare = ifelse(ess_raw$hincsrca == 5 | ess_raw$hincsrca == 6, 1, 0)

ses_mean = ess_raw %>% filter(citizen == 1, fborn == 0) %>% group_by(cntry) %>% 
  select(pdjobev, pdjobyr, emplno, wrkctr, jbspv, wkdcorga, wkhtot, skill, blue, contract, hinctnt, uemp3m, uemp12m, uemp5yr, soc.welfare, brwmny) %>%
  summarise(mean.pdjobev = mean(pdjobev, na.rm = TRUE),
            mean.pdjobyr = mean(pdjobyr, na.rm = TRUE),
            mean.emplno = mean(emplno, na.rm = TRUE),
            mean.wrkctr = mean(wrkctr, na.rm = TRUE),
            mean.jbspv = mean(jbspv, na.rm = TRUE), 
            mean.wkdcorga = mean(wkdcorga, na.rm = TRUE), 
            mean.wkhtot = mean(wkhtot, na.rm = TRUE), 
            mean.skill = mean(skill, na.rm = TRUE),
            mean.blue = mean(blue, na.rm = TRUE),
            mean.contract = mean(contract, na.rm = TRUE),
            mean.hinctnt = mean(hinctnt, na.rm = TRUE), 
            mean.uemp3m = mean(uemp3m, na.rm = TRUE),
            mean.uemp12m = mean(uemp12m, na.rm = TRUE),
            mean.uemp5yr = mean(uemp5yr, na.rm = TRUE), 
            mean.soc.welfare = mean(soc.welfare, na.rm = TRUE),
            mean.brwmny = mean(brwmny, na.rm = TRUE))

ess_ses = ess_raw %>% filter(residence == 1)
ess_ses = ess_ses %>% left_join(ses_mean, by='cntry')

ses_h = ess_ses %>% filter(cntry %in% c("DK", "NL", "DE", "AT", "FR", "GB", "GR"))
ses_l = ess_ses %>% filter(cntry %in% c("IE", "SE", "BE", "PT", "ES", "FI","LU", "IT"))

ses_h = ses_h %>%  mutate(
  pdjobev.gap = pdjobev - mean.pdjobev, 
  pdjobyr.gap = pdjobyr - mean.pdjobyr,
  emplno.gap = emplno - mean.emplno,
  wrkctr.gap = wrkctr - mean.wrkctr,
  jbspv.gap = jbspv - mean.jbspv, 
  wkdcorga.gap = wkdcorga - mean.wkdcorga,
  wkhtot.gap = wkhtot - mean.wkhtot,
  skill.gap = skill - mean.skill,
  blue.gap = blue - mean.blue,
  contract.gap = contract - mean.contract,
  hinctnt.gap = hinctnt - mean.hinctnt, 
  uemp3m.gap = uemp3m - mean.uemp3m,
  uemp12m.gap = uemp12m - mean.uemp12m,
  uemp5yr.gap = uemp5yr - mean.uemp5yr,
  soc.welfare.gap = soc.welfare - mean.soc.welfare,
  brwmny.gap = brwmny - mean.brwmny
  )

ses_l = ses_l %>%  mutate(
  pdjobev.gap = pdjobev - mean.pdjobev, 
  pdjobyr.gap = pdjobyr - mean.pdjobyr,
  emplno.gap = emplno - mean.emplno,
  wrkctr.gap = wrkctr - mean.wrkctr,
  jbspv.gap = jbspv - mean.jbspv, 
  wkdcorga.gap = wkdcorga - mean.wkdcorga,
  wkhtot.gap = wkhtot - mean.wkhtot,
  skill.gap = skill - mean.skill,
  blue.gap = blue - mean.blue,
  contract.gap = contract - mean.contract,
  hinctnt.gap = hinctnt - mean.hinctnt, 
  uemp3m.gap = uemp3m - mean.uemp3m,
  uemp12m.gap = uemp12m - mean.uemp12m,
  uemp5yr.gap = uemp5yr - mean.uemp5yr,
  soc.welfare.gap = soc.welfare - mean.soc.welfare,
  brwmny.gap = brwmny - mean.brwmny
  )
```

```{r pdjobev, warning=FALSE, message=FALSE, fig.height=1.5, fig.cap='Ever had a paid job (1 as yes)'}
pdjobev.h.1 = glm(pdjobev ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
pdjobev.h.2 = lm(pdjobev.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
pdjobev.l.1 = glm(pdjobev ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
pdjobev.l.2 = lm(pdjobev.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

pdjobev.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = pdjobev.h.1 %>% 
  broom::augment(newdata = pdjobev.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

pdjobev.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = pdjobev.l.1 %>% 
  broom::augment(newdata = pdjobev.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(pdjobev.h.2$coefficients[1],confint(pdjobev.h.2)[1,]))
gap.l = as.vector(c(pdjobev.l.2$coefficients[1],confint(pdjobev.l.2)[1,]))

pdjobev.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pdjobev.1) = c("intercept", "min", "max")
pdjobev.1 = pdjobev.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pdjobev.1$var = factor(pdjobev.1$var, as.character(pdjobev.1$var))

ggplot(pdjobev.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1.5, 1.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r pdjobyr, fig.height=1.5, fig.cap='Number of years to the last paid job'}
pdjobyr.h.1 = lm(pdjobyr ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
pdjobyr.h.2 = lm(pdjobyr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
pdjobyr.l.1 = lm(pdjobyr ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
pdjobyr.l.2 = lm(pdjobyr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(pdjobyr.h.1$coefficients[1],confint(pdjobyr.h.1)[1,]))
absolute.l = as.vector(c(pdjobyr.l.1$coefficients[1],confint(pdjobyr.l.1)[1,]))

gap.h = as.vector(c(pdjobyr.h.2$coefficients[1],confint(pdjobyr.h.2)[1,]))
gap.l = as.vector(c(pdjobyr.l.2$coefficients[1],confint(pdjobyr.l.2)[1,]))

pdjobyr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(pdjobyr.1) = c("intercept", "min", "max")
pdjobyr.1 = pdjobyr.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
pdjobyr.1$var = factor(pdjobyr.1$var, as.character(pdjobyr.1$var))

ggplot(pdjobyr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-25, 25)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r self.emply, warning=FALSE, message=FALSE, fig.height=1.5, fig.cap=''}
self.emply.h.1 = glm(self.emply ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
self.emply.l.1 = glm(self.emply ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

self.emply.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = self.emply.h.1 %>% 
  broom::augment(newdata = self.emply.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

self.emply.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = self.emply.l.1 %>% 
  broom::augment(newdata = self.emply.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

# gap.h = as.vector(c(pdjobev.h.2$coefficients[1],confint(pdjobev.h.2)[1,]))
# gap.l = as.vector(c(pdjobev.l.2$coefficients[1],confint(pdjobev.l.2)[1,]))

self.emply.1 = as.data.frame(rbind(absolute.h, absolute.l))
colnames(self.emply.1) = c("intercept", "min", "max")
self.emply.1 = self.emply.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)'))
self.emply.1$var = factor(self.emply.1$var, as.character(self.emply.1$var))

ggplot(self.emply.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-4, 4)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```


```{r emplno, fig.height=1.5, fig.cap='Number of employees'}
emplno.h.1 = lm(emplno ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
emplno.h.2 = lm(emplno.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
emplno.l.1 = lm(emplno ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
emplno.l.2 = lm(emplno.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(emplno.h.1$coefficients[1],confint(emplno.h.1)[1,]))
absolute.l = as.vector(c(emplno.l.1$coefficients[1],confint(emplno.l.1)[1,]))

gap.h = as.vector(c(emplno.h.2$coefficients[1],confint(emplno.h.2)[1,]))
gap.l = as.vector(c(emplno.l.2$coefficients[1],confint(emplno.l.2)[1,]))

emplno.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(emplno.1) = c("intercept", "min", "max")
emplno.1 = emplno.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
emplno.1$var = factor(emplno.1$var, as.character(emplno.1$var))

ggplot(emplno.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-25, 50)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r wrkctr, fig.height=1.5, fig.cap='Whether employeed under contract with limited duration'}

wrkctr.h.1 = glm(wrkctr ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
wrkctr.h.2 = lm(wrkctr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
wrkctr.l.1 = glm(wrkctr ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
wrkctr.l.2 = lm(wrkctr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

wrkctr.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = wrkctr.h.1 %>% 
  broom::augment(newdata = wrkctr.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

wrkctr.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = wrkctr.l.1 %>% 
  broom::augment(newdata = wrkctr.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(wrkctr.h.2$coefficients[1],confint(wrkctr.h.2)[1,]))
gap.l = as.vector(c(wrkctr.l.2$coefficients[1],confint(wrkctr.l.2)[1,]))

wrkctr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wrkctr.1) = c("intercept", "min", "max")
wrkctr.1 = wrkctr.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wrkctr.1$var = factor(wrkctr.1$var, as.character(wrkctr.1$var))

ggplot(wrkctr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1.5, 1.5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r contract, fig.height=1.5, fig.cap='Whether employeed under contract at all'}

contract.h.1 = glm(contract ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
contract.h.2 = lm(contract.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
contract.l.1 = glm(contract ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
contract.l.2 = lm(contract.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

contract.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = contract.h.1 %>% 
  broom::augment(newdata = contract.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

contract.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = contract.l.1 %>% 
  broom::augment(newdata = contract.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(contract.h.2$coefficients[1],confint(contract.h.2)[1,]))
gap.l = as.vector(c(contract.l.2$coefficients[1],confint(contract.l.2)[1,]))

contract.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(contract.1) = c("intercept", "min", "max")
contract.1 = contract.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
contract.1$var = factor(contract.1$var, as.character(contract.1$var))

ggplot(contract.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2, 2)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r jbspv, fig.height=1.5, fig.cap='Whether supervise other employees'}

jbspv.h.1 = glm(jbspv ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
jbspv.h.2 = lm(jbspv.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
jbspv.l.1 = glm(jbspv ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
jbspv.l.2 = lm(jbspv.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

jbspv.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = jbspv.h.1 %>% 
  broom::augment(newdata = jbspv.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

jbspv.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = jbspv.l.1 %>% 
  broom::augment(newdata = jbspv.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(jbspv.h.2$coefficients[1],confint(jbspv.h.2)[1,]))
gap.l = as.vector(c(jbspv.l.2$coefficients[1],confint(jbspv.l.2)[1,]))

jbspv.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(jbspv.1) = c("intercept", "min", "max")
jbspv.1 = jbspv.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
jbspv.1$var = factor(jbspv.1$var, as.character(jbspv.1$var))

ggplot(jbspv.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-2, 2)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")

```

```{r wkdcorga, fig.height=1.5, fig.cap='How much control over organization of daily work (0 as no influence, 10 as complete control)'}
wkdcorga.h.1 = lm(wkdcorga ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
wkdcorga.h.2 = lm(wkdcorga.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
wkdcorga.l.1 = lm(wkdcorga ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
wkdcorga.l.2 = lm(wkdcorga.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(wkdcorga.h.1$coefficients[1],confint(wkdcorga.h.1)[1,]))
absolute.l = as.vector(c(wkdcorga.l.1$coefficients[1],confint(wkdcorga.l.1)[1,]))

gap.h = as.vector(c(wkdcorga.h.2$coefficients[1],confint(wkdcorga.h.2)[1,]))
gap.l = as.vector(c(wkdcorga.l.2$coefficients[1],confint(wkdcorga.l.2)[1,]))

wkdcorga.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wkdcorga.1) = c("intercept", "min", "max")
wkdcorga.1 = wkdcorga.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wkdcorga.1$var = factor(wkdcorga.1$var, as.character(wkdcorga.1$var))

ggplot(wkdcorga.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-25, 50)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```



```{r wkhtot, fig.height=1.5, fig.cap='Hours normally worked per week'}
wkhtot.h.1 = lm(wkhtot ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
wkhtot.h.2 = lm(wkhtot.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
wkhtot.l.1 = lm(wkhtot ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
wkhtot.l.2 = lm(wkhtot.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(wkhtot.h.1$coefficients[1],confint(wkhtot.h.1)[1,]))
absolute.l = as.vector(c(wkhtot.l.1$coefficients[1],confint(wkhtot.l.1)[1,]))

gap.h = as.vector(c(wkhtot.h.2$coefficients[1],confint(wkhtot.h.2)[1,]))
gap.l = as.vector(c(wkhtot.l.2$coefficients[1],confint(wkhtot.l.2)[1,]))

wkhtot.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(wkhtot.1) = c("intercept", "min", "max")
wkhtot.1 = wkhtot.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
wkhtot.1$var = factor(wkhtot.1$var, as.character(wkhtot.1$var))

ggplot(wkhtot.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-50, 50)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r skill, fig.height=1.5, fig.cap='Skilled worker (1) or not (0)'}
skill.h.1 = glm(skill ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
skill.h.2 = lm(skill.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
skill.l.1 = glm(skill ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
skill.l.2 = lm(skill.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

skill.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = skill.h.1 %>% 
  broom::augment(newdata = skill.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

skill.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = skill.l.1 %>% 
  broom::augment(newdata = skill.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(skill.h.2$coefficients[1],confint(skill.h.2)[1,]))
gap.l = as.vector(c(skill.l.2$coefficients[1],confint(skill.l.2)[1,]))

skill.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(skill.1) = c("intercept", "min", "max")
skill.1 = skill.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
skill.1$var = factor(skill.1$var, as.character(skill.1$var))

ggplot(skill.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```

```{r blue, fig.height=1.5, fig.cap='Blue collar (1) or not (0)'}
blue.h.1 = glm(blue ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
blue.h.2 = lm(blue.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
blue.l.1 = glm(blue ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
blue.l.2 = lm(blue.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

blue.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = blue.h.1 %>% 
  broom::augment(newdata = blue.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

blue.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = blue.l.1 %>% 
  broom::augment(newdata = blue.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(blue.h.2$coefficients[1],confint(blue.h.2)[1,]))
gap.l = as.vector(c(blue.l.2$coefficients[1],confint(blue.l.2)[1,]))

blue.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(blue.1) = c("intercept", "min", "max")
blue.1 = blue.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
blue.1$var = factor(blue.1$var, as.character(blue.1$var))

ggplot(blue.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("")
```
```{r hinctnt, fig.height=1.5, fig.cap='Household total net income (10 levels)'}
hinctnt.h.1 = lm(hinctnt ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
hinctnt.h.2 = lm(hinctnt.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
hinctnt.l.1 = lm(hinctnt ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
hinctnt.l.2 = lm(hinctnt.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(hinctnt.h.1$coefficients[1],confint(hinctnt.h.1)[1,]))
absolute.l = as.vector(c(hinctnt.l.1$coefficients[1],confint(hinctnt.l.1)[1,]))

gap.h = as.vector(c(hinctnt.h.2$coefficients[1],confint(hinctnt.h.2)[1,]))
gap.l = as.vector(c(hinctnt.l.2$coefficients[1],confint(hinctnt.l.2)[1,]))

hinctnt.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(hinctnt.1) = c("intercept", "min", "max")
hinctnt.1 = hinctnt.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
hinctnt.1$var = factor(hinctnt.1$var, as.character(hinctnt.1$var))

ggplot(hinctnt.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Household's total net income: 10 levels (intercept)")
```

```{r uemp3m, fig.height=1.5, fig.cap='Unemployed and seeking work for more than three mos (1 as yes)'}
uemp3m.h.1 = glm(uemp3m ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
uemp3m.h.2 = lm(uemp3m.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
uemp3m.l.1 = glm(uemp3m ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
uemp3m.l.2 = lm(uemp3m.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

uemp3m.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = uemp3m.h.1 %>% 
  broom::augment(newdata = uemp3m.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

uemp3m.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = uemp3m.l.1 %>% 
  broom::augment(newdata = uemp3m.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(uemp3m.h.2$coefficients[1],confint(uemp3m.h.2)[1,]))
gap.l = as.vector(c(uemp3m.l.2$coefficients[1],confint(uemp3m.l.2)[1,]))

uemp3m.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(uemp3m.1) = c("intercept", "min", "max")
uemp3m.1 = uemp3m.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
uemp3m.1$var = factor(uemp3m.1$var, as.character(uemp3m.1$var))

ggplot(uemp3m.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Unemployed and seeking work for more than three months (intercept)")
```

```{r uemp12m, fig.height=1.5, fig.cap='Unemployed and seeking work for more than 12 mos (1 as yes)'}
uemp12m.h.1 = glm(uemp12m ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
uemp12m.h.2 = lm(uemp12m.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
uemp12m.l.1 = glm(uemp12m ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
uemp12m.l.2 = lm(uemp12m.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

uemp12m.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = uemp12m.h.1 %>% 
  broom::augment(newdata = uemp12m.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

uemp12m.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = uemp12m.l.1 %>% 
  broom::augment(newdata = uemp12m.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(uemp12m.h.2$coefficients[1],confint(uemp12m.h.2)[1,]))
gap.l = as.vector(c(uemp12m.l.2$coefficients[1],confint(uemp12m.l.2)[1,]))

uemp12m.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(uemp12m.1) = c("intercept", "min", "max")
uemp12m.1 = uemp12m.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
uemp12m.1$var = factor(uemp12m.1$var, as.character(uemp12m.1$var))

ggplot(uemp12m.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Unemployed and seeking work for more than twelve months (intercept)")
```

```{r uemp5yr, fig.height=1.5, fig.cap='Unemployed and seeking work for more than 5 yrs (1 as yes)'}
uemp5yr.h.1 = glm(uemp5yr ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
uemp5yr.h.2 = lm(uemp5yr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
uemp5yr.l.1 = glm(uemp5yr ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
uemp5yr.l.2 = lm(uemp5yr.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

uemp5yr.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = uemp5yr.h.1 %>% 
  broom::augment(newdata = uemp5yr.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

uemp5yr.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = uemp5yr.l.1 %>% 
  broom::augment(newdata = uemp5yr.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(uemp5yr.h.2$coefficients[1],confint(uemp5yr.h.2)[1,]))
gap.l = as.vector(c(uemp5yr.l.2$coefficients[1],confint(uemp5yr.l.2)[1,]))

uemp5yr.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(uemp5yr.1) = c("intercept", "min", "max")
uemp5yr.1 = uemp5yr.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
uemp5yr.1$var = factor(uemp5yr.1$var, as.character(uemp5yr.1$var))

ggplot(uemp5yr.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-1, 1)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Unemployed and seeking work for more than five years (intercept)")
```

```{r soc.welfare, fig.height=1.5, fig.cap='Depend on social benefits'}
soc.welfare.h.1 = glm(soc.welfare ~ agea + ethnic + female + edu + eubirth, data = ses_h, family = 'binomial') # absolute level
soc.welfare.h.2 = lm(soc.welfare.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
soc.welfare.l.1 = glm(soc.welfare ~ agea + ethnic + female + edu + eubirth, data = ses_l, family = 'binomial') # absolute level
soc.welfare.l.2 = lm(soc.welfare.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

# absolute.h = as.vector(c(dscrgrp.h.1$coefficients[1],confint(dscrgrp.h.1)[1,]))
# absolute.l = as.vector(c(dscrgrp.l.1$coefficients[1],confint(dscrgrp.l.1)[1,]))

soc.welfare.dat.h = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.h = soc.welfare.h.1 %>% 
  broom::augment(newdata = soc.welfare.dat.h, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>% 
  select(.fitted, upper, lower) 

soc.welfare.dat.l = with(ses_h, data.frame(agea = mean(agea, na.rm = T),
                                        ethnic = mean(ethnic, na.rm = T),
                                        female = mean(female, na.rm = T),
                                        eubirth = mean(eubirth, na.rm = T),
                                        edu = mean(edu, na.rm = T)))

absolute.l = soc.welfare.l.1 %>% 
  broom::augment(newdata = soc.welfare.dat.l, predict = "response") %>%
  mutate(upper = .fitted + 1.96 * .se.fit,
         lower = .fitted - 1.96 * .se.fit) %>%
  select(.fitted, upper, lower)

gap.h = as.vector(c(soc.welfare.h.2$coefficients[1],confint(soc.welfare.h.2)[1,]))
gap.l = as.vector(c(soc.welfare.l.2$coefficients[1],confint(soc.welfare.l.2)[1,]))

soc.welfare.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(soc.welfare.1) = c("intercept", "min", "max")
soc.welfare.1 = soc.welfare.1 %>% mutate(var = c('High CIVIX: Abs. Level (predicted)', 'Low CIVIX: Abs. Level (predicted)','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
soc.welfare.1$var = factor(soc.welfare.1$var, as.character(soc.welfare.1$var))

ggplot(soc.welfare.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-3, 3)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("Social benefits as the main sources of household income (intercept)")
```

```{r, brwmny, fig.height=5, fig.cap='How difficultt to borrow money (1: very difficult, 5: very easy)'}
brwmny.h.1 = lm(brwmny ~ agea + ethnic + female + edu + eubirth, data = ses_h) # absolute level
brwmny.h.2 = lm(brwmny.gap ~ agea + ethnic + female + edu + eubirth, data = ses_h) # gap
brwmny.l.1 = lm(brwmny ~ agea + ethnic + female + edu + eubirth, data = ses_l) # absolute level
brwmny.l.2 = lm(brwmny.gap ~ agea + ethnic + female + edu + eubirth, data = ses_l) # gap

absolute.h = as.vector(c(brwmny.h.1$coefficients[1],confint(brwmny.h.1)[1,]))
absolute.l = as.vector(c(brwmny.l.1$coefficients[1],confint(brwmny.l.1)[1,]))

gap.h = as.vector(c(brwmny.h.2$coefficients[1],confint(brwmny.h.2)[1,]))
gap.l = as.vector(c(brwmny.l.2$coefficients[1],confint(brwmny.l.2)[1,]))

brwmny.1 = as.data.frame(rbind(absolute.h, absolute.l, gap.h, gap.l))
colnames(brwmny.1) = c("intercept", "min", "max")
brwmny.1 = brwmny.1 %>% mutate(var = c('High CIVIX: Absolute Level', 'Low CIVIX: Absolute Level','High CIVIX: Gap w/Natives','Low CIVIX: Gap w/Natives'))
brwmny.1$var = factor(brwmny.1$var, as.character(brwmny.1$var))

ggplot(brwmny.1,aes(y=var)) + 
  geom_point(aes(x = intercept)) + 
  geom_errorbarh(aes(xmin = min, xmax = max)) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  geom_vline(xintercept = 0, linetype = "dashed") +
  ylab("") + 
  xlab("How easy to borrow money: 1 as very difficult and 5 as very easy (intercept)")
```
